<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Create Your Obituary">
    <meta property="og:description" content="Fill in the details to create your obituary page. Leave a legacy that people will cherish.">
    <meta property="og:image" content="https://reelcareer.co/images/8pic_rc.png"> <!-- Replace with actual image URL -->
    <meta property="og:url" content="https://reelcareer.co/obituaries/">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Create Your Obituary">
    <meta name="twitter:description" content="Fill in the details to create your obituary page. Leave a legacy that people will cherish.">
    <meta name="twitter:image" content="https://reelcareer.co/images/8pic_rc.png"> <!-- Replace with actual image URL -->
    <meta name="twitter:url" content="https://reelcareer.co/obituaries/">
    
    <!-- General Meta Tags -->
    <meta name="description" content="Create your personalized obituary page. Add details, photos, and memories to leave a lasting legacy.">
    <meta name="keywords" content="obituary, create obituary, legacy, remembrance, celebration of life">
    <meta name="author" content="ReelCareer">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#ffffff">
      <!-- Canonical Tag for SEO -->
  <link rel="canonical" href="https://reelcareer.co/obituaries/"> <!-- Ensures search engines index the preferred URL -->

  <!-- Standard Favicon -->
  <link rel="icon" type="image/x-icon" href="https://reelcareer.co/images/favicons/favicon.ico">

    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "url": "https://reelcareer.co/obituaries/",
      "name": "Create Your Obituary",
      "description": "Create your personalized obituary page. Add details, photos, and memories to leave a lasting legacy.",
      "author": {
        "@type": "Organization",
        "name": "ReelCareer",
        "url": "https://reelcareer.co/"
      },
      "publisher": {
        "@type": "Organization",
        "name": "ReelCareer",
        "url": "https://reelcareer.co/",
        "logo": {
          "@type": "ImageObject",
          "url": "https://reelcareer.co/images/8pic_rc.png", 
          "width": 200,
          "height": 60
        }
      },
      "image": {
        "@type": "ImageObject",
        "url": "https://reelcareer.co/images/8pic_rc.png", 
        "width": 1200,
        "height": 630
      }
    }
    </script>
    

    <!-- CSS Stylesheets -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">

    <!-- JS Scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>



    <link href="https://reelcareer.co/obituaries/style.css" rel="stylesheet">

   <style>


        .cards-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }

        .obituary-card {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 10px;
            width: 280px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            padding: 15px;
            text-align: center;
            transition: transform 0.2s ease-in-out;
        }

        .obituary-card:hover {
            transform: scale(1.05);
        }

        .obituary-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            border-radius: 8px;
        }

        .obituary-card h3 {
            font-size: 1.5em;
            margin-top: 10px;
            color: #333;
        }

        .obituary-card p {
            color: #777;
            font-size: 1em;
        }

        .obituary-card .button {
            padding: 10px;
            background-color: #ff8c00;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            margin-top: 10px;
            display: inline-block;
        }

        .obituary-card .button:hover {
            background-color: #ffa733;
        }

        .info-section {
    background: #ffffff;
    border: 1px solid #e0e0e0;
    border-radius: 10px;
    padding: 20px 25px;
    margin: 20px 0;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    font-family: 'Arial', sans-serif;
    color: #333;
}

.info-section h2 {
    font-size: 1.8rem;
    margin-bottom: 15px;
    color: #007bff;
}

.info-section p {
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 20px;
    color: #555;
}

.info-section ul {
    list-style: none;
    padding: 0;
    margin: 0 0 20px;
}

.info-section ul li {
    font-size: 1rem;
    margin: 10px 0;
    display: flex;
    align-items: flex-start;
}

.info-section ul li strong {
    color: #04305f;
    margin-right: 8px;
}

.info-section ul li::before {
    content: 'âœ”';
    font-size: 1.2rem;
    color: #036e1c;
    margin-right: 10px;
}

.cta-container {
    text-align: center;
}

.cta-button {
    display: inline-block;
    padding: 12px 20px;
    font-size: 1rem;
    color: #ffffff;
    background: #007bff;
    border: none;
    border-radius: 5px;
    text-decoration: none;
    transition: background 0.3s ease;
    box-shadow: 0 3px 6px rgba(0, 123, 255, 0.3);
}

.cta-button:hover {
    background: #0056b3;
    box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
}


    </style>
</head>

<body>

    <!-- Header Section -->
    <header>
        <h1>Obituaries</h1>
    </header>

    <!-- Breadcrumb Section -->
    <div class="breadcrumb">
        <a href="https://reelcareer.co/">Home</a> | <a href="https://reelcareer.co/obituaries">Obituaries</a> | <a href="https://reelcareer.co/obituaries/create">Create</a>
    </div>

    <!-- Main Content Section -->
    <main>
        <div class="section-header">
            <h2>Obituaries</h2>
            <p>Browse through obituaries categorized by location and memory.</p>
        </div>

        <div class="cards-container" id="obituaries-list">
            <!-- Obituaries Cards will be injected here from JS -->
        </div>

    <!-- Info Section about Creating an Obituary -->
    <div id="info-section" class="info-section">
        <h2>Create Your Legacy</h2>
        <p>
            For just <strong>$25</strong>, craft a personalized obituary that celebrates your journey, achievements, and cherished memories. 
            Share your story with the world and leave a meaningful legacy.
        </p>
        <ul>
            <li><strong>Photo & Video Upload:</strong> Personalize your page with visuals that tell your story.</li>
            <li><strong>Life Story & Accomplishments:</strong> Highlight key milestones and memories.</li>
            <li><strong>Interactive Features:</strong> Include social media links and receive tribute messages.</li>
            <li><strong>Lifetime Access:</strong> View and update your page whenever you want.</li>
        </ul>
        <div class="cta-container">
            <a href="https://reelcareer.co/obituaries/create" class="cta-button">Start Your Obituary</a>
        </div>
    </div>
    
</main>

    <!-- Footer Section -->
    <footer class="site-footer">
        <div class="footer-content">
            <p>Leave a lasting legacy. Share your story with the world.</p>
            <nav class="footer-nav">
                <a href="https://reelcareer.co/obituaries/">Obituaries</a>
                <a href="https://reelcareer.co/obituaries/create">Create an Obituary</a>
                <a href="https://reelcareer.co/">Home</a>
            </nav>
            <p>&copy; <span id="currentYear"></span> ReelCareer.co. All rights reserved.</p>
        </div>
    </footer>
    
<!-- Include Firebase SDK as a module -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js";
import { getStorage } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-storage.js";
import { 
    getAuth, signInAnonymously, onAuthStateChanged 
} from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";

    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyDiwC3Dmd88-t3N9iRV5cZ3snVkEXinclg",
        authDomain: "reelcareer-cb4b0.firebaseapp.com",
        projectId: "reelcareer-cb4b0",
        storageBucket: "reelcareer-cb4b0.appspot.com",
        messagingSenderId: "365163764840",
        appId: "1:365163764840:web:21c44f8625c9b6831e6fdd",
        measurementId: "G-LBTK319K2X"
    };

    // Initialize Firebase services
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const storage = getStorage(app);
    const auth = getAuth(app);

    // Sign in anonymously
    signInAnonymously(auth)
        .then(() => {
            console.log('Signed in anonymously');
        })
        .catch((error) => {
            console.error('Error signing in anonymously:', error);
        });
let userID = '';

// Listen for authentication state changes to get the user ID
onAuthStateChanged(auth, async (user) => {
  if (user) {
    // The user is signed in
     userID = user.uid; // Use the user's unique ID
    console.log("User ID:", userID);

    // Check localStorage for obituaryMemberID
    const obituaryMemberID = localStorage.getItem("obituaryMemberID");

    if (!obituaryMemberID) {
      // If obituaryMemberID is not set, proceed to add to Firestore
      try {
        // Get the user's IP address
        const userDetails = await getUserDetails(); // Assuming getUserDetails fetches IP and location details
        if (!userDetails) return;

        const { ip: userIP, city, state, country } = userDetails; // Destructure user details

        console.log("!!!!!!!!!!!!!!!!  User data logged to Firestore");
      } catch (error) {
        console.error("Error logging user data to Firestore:", error);
      }
    } else {
      console.log("User already recorded with obituaryMemberID:", obituaryMemberID);
    }
  } else {
    console.log("No user signed in");
  }
});
  
async function loadUserObituaries(userID) {
    const userRef = doc(db, "Users", userID);
    const userDoc = await getDoc(userRef);

    if (userDoc.exists()) {
        const data = userDoc.data();
        const obituaryPageIDs = data.obituaryPageID || [];
        const obituaryPageNames = data.obituaryPageName || [];

        const container = document.getElementById("info-section");
        container.innerHTML = ""; // Clear previous content

        // Loop through obituaries and create a card for each
        for (let i = 0; i < obituaryPageIDs.length; i++) {
            const pageID = obituaryPageIDs[i];
            const pageName = obituaryPageNames[i];

            const card = document.createElement("div");
            card.classList.add("user-obituary-card");

            card.innerHTML = `
                <h3>${pageName}</h3>
                <p>Page ID: ${pageID}</p>
                <div class="controls">
                    <button id="edit_${pageID}">Edit</button>
                    <button id="analytics_${pageID}">Analytics</button>
                    <button id="view_${pageID}">View</button>
                </div>
            `;

            // Add event listeners for the buttons
            card.querySelector(`#edit_${pageID}`).addEventListener("click", () => goToEditPage(pageID));
            card.querySelector(`#analytics_${pageID}`).addEventListener("click", () => goToAnalyticsPage(pageID));
            card.querySelector(`#view_${pageID}`).addEventListener("click", () => goToViewPage(pageID));

            container.appendChild(card);
        }
    } else {
        console.log("No obituary data found for the user.");
    }
}

// Functions to handle button actions
function goToEditPage(pageID) {
    window.location.href = `/edit-obituary.html?pageID=${encodeURIComponent(pageID)}`;
}

function goToAnalyticsPage(pageID) {
    window.location.href = `/analytics-obituary.html?pageID=${encodeURIComponent(pageID)}`;
}

function goToViewPage(pageID) {
    window.location.href = `/view-obituary.html?pageID=${encodeURIComponent(pageID)}`;
}

// Call this function when the page loads
loadUserObituaries(userID);




// Function to fetch obituaries from Firestore

async function fetchObituaries() { 
    try {
        // Correct method to get collection in Firebase v9
        const obituariesCollection = collection(db, 'A_Obituaries');
        
        // Fetch all documents from the A_Obituaries collection
        const querySnapshot = await getDocs(obituariesCollection);
        
        // Create an array of obituary data
        const obituaries = querySnapshot.docs.map(doc => doc.data());
        console.log("    obituaries:", obituaries);

        // Render the fetched obituaries
        renderObituaries(obituaries);
    } catch (error) {
        console.error("Error fetching obituaries:", error);
    }
}
// Function to render obituary cards
function renderObituaries(obituaries) {
    const container = document.getElementById("obituaries-list");
    container.innerHTML = "";  // Clear previous list

    // Loop through obituaries and create a card for each
    obituaries.forEach(obituary => {
        const card = document.createElement("div");
        card.classList.add("obituary-card");

        card.innerHTML = `
            <img src="${obituary.mainPhoto}" alt="Obituary Image">
            <h3>${obituary.name}</h3>
            <p><strong>Category:</strong> ${obituary.category}</p>
            <p><strong>Services will be held:</strong> ${obituary.location}</p>
<p>${obituary.about.length > 80 ? obituary.about.substring(0, 80) + '...' : obituary.about}</p>
            <a href="${obituary.url}" class="button">View Obituary</a>
        `;


        container.appendChild(card);
    });
}


// Call the fetch function when the page loads
fetchObituaries();


    </script>
<script>
    // Dynamically set the current year
    document.getElementById("currentYear").textContent = new Date().getFullYear();
</script>
<script src="https://reelcareer.co/obituaries/setup/analytics.js" type="module"></script>

</body>

</html>
