<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Create Your Obituary">
    <meta property="og:description" content="Fill in the details to create your obituary page. Leave a legacy that people will cherish.">
    <meta property="og:image" content="https://reelcareer.co/images/8pic_rc.png"> <!-- Replace with actual image URL -->
    <meta property="og:url" content="https://reelcareer.co/obituaries/">
    <meta property="og:type" content="website">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Create Your Obituary">
    <meta name="twitter:description" content="Fill in the details to create your obituary page. Leave a legacy that people will cherish.">
    <meta name="twitter:image" content="https://reelcareer.co/images/8pic_rc.png"> <!-- Replace with actual image URL -->
    <meta name="twitter:url" content="https://reelcareer.co/obituaries/">
    
    <!-- General Meta Tags -->
    <meta name="description" content="Create your personalized obituary page. Add details, photos, and memories to leave a lasting legacy.">
    <meta name="keywords" content="obituary, create obituary, legacy, remembrance, celebration of life">
    <meta name="author" content="ReelCareer">
    <meta name="robots" content="index, follow">
    <meta name="theme-color" content="#ffffff">
      <!-- Canonical Tag for SEO -->
  <link rel="canonical" href="https://reelcareer.co/obituaries/"> <!-- Ensures search engines index the preferred URL -->

  <!-- Standard Favicon -->
  <link rel="icon" type="image/x-icon" href="https://reelcareer.co/images/favicons/favicon.ico">
  
  <title>Career Obituaries | ReelCareer</title>

    <!-- Schema.org Structured Data -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "url": "https://reelcareer.co/obituaries/",
      "name": "Create Your Obituary",
      "description": "Create your personalized obituary page. Add details, photos, and memories to leave a lasting legacy.",
      "author": {
        "@type": "Organization",
        "name": "ReelCareer",
        "url": "https://reelcareer.co/"
      },
      "publisher": {
        "@type": "Organization",
        "name": "ReelCareer",
        "url": "https://reelcareer.co/",
        "logo": {
          "@type": "ImageObject",
          "url": "https://reelcareer.co/images/8pic_rc.png", 
          "width": 200,
          "height": 60
        }
      },
      "image": {
        "@type": "ImageObject",
        "url": "https://reelcareer.co/images/8pic_rc.png", 
        "width": 1200,
        "height": 630
      }
    }
    </script>
    


<!-- Main Script Loader -->
<script src="https://reelcareer.co/scripts/js/loader.js"></script>



<style>

main {

    .cards-container {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        justify-content: center;
    }

    .obituary-card {
        background-color: #fff;
        border: 1px solid #ddd;
        border-radius: 10px;
        width: 280px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        padding: 15px;
        text-align: center;
        transition: transform 0.2s ease-in-out;
    }

    .obituary-card:hover {
        transform: scale(1.05);
    }

    .obituary-card img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        border-radius: 8px;
    }

    .obituary-card h3 {
        font-size: 1.5em;
        margin-top: 10px;
        color: #333;
    }

    .obituary-card p {
        color: #777;
        font-size: 1em;
    }

    .obituary-card .button {
        padding: 10px;
        background-color: #ff8c00;
        color: white;
        text-decoration: none;
        border-radius: 5px;
        margin-top: 10px;
        display: inline-block;
    }

    .obituary-card .button:hover {
        background-color: #ffa733;
    }

    .info-section {
background: #ffffff;
border: 1px solid #e0e0e0;
border-radius: 10px;
padding: 20px 25px;
margin: 20px 0;
box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
font-family: 'Arial', sans-serif;
color: #333;
}

.info-section h2 {
font-size: 1.8rem;
margin-bottom: 15px;
color: #007bff;
}

.info-section p {
font-size: 1rem;
line-height: 1.6;
margin-bottom: 20px;
color: #555;
}

.info-section ul {
list-style: none;
padding: 0;
margin: 0 0 20px;
}

.info-section ul li {
font-size: 1rem;
margin: 10px 0;
display: flex;
align-items: flex-start;
}

.info-section ul li strong {
color: #04305f;
margin-right: 8px;
}

.info-section ul li::before {
content: 'âœ”';
font-size: 1.2rem;
color: #036e1c;
margin-right: 10px;
}

.cta-container {
text-align: center;
}

.cta-button {
display: inline-block;
padding: 12px 20px;
font-size: 1rem;
color: #ffffff;
background: #007bff;
border: none;
border-radius: 5px;
text-decoration: none;
transition: background 0.3s ease;
box-shadow: 0 3px 6px rgba(0, 123, 255, 0.3);
}

.cta-button:hover {
background: #0056b3;
box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
}

 
}    
</style>

</head>
<body>

  <!-- Navigation Bar -->
  <nav id="Main-Nav_bar" class="navbar navbar-expand-lg main-navbar-light shadow-sm sticky-top" role="navigation">
    <div class="container d-flex align-items-center justify-content-between">
      <!-- Logo -->
      <a class="navbar-brand embossed" id="MAIN-LOGO-Reel-Career" href="https://reelcareer.co/" aria-label="Go to home page">
        ReelCareer
      </a>

      <!-- Always-visible Icons -->
      <ul class="navbar-nav d-flex flex-row justify-content-center flex-grow-1" id="iconBar">
        
      <li class="nav-item mx-2">
        <a class="nav-link" href="https://reelcareer.co/job-listings" aria-label="Go to job listings page">
          <i class="fa fa-briefcase"></i>
        </a>
      </li>
      <li class="nav-item mx-2">
        <a class="nav-link" href="https://reelcareer.co/reels" aria-label="Go to reels page">
          <i class="fa fa-video"></i>
        </a>
      </li>
      <li class="nav-item mx-2">
        <a class="nav-link" href="https://reelcareer.co/views/membership" aria-label="Go to membership page">
          <i class="fa fa-user"></i>
        </a>
      </li>
      <li class="nav-item mx-2">
        <a class="nav-link" href="https://reelcareer.co/views/blogs" aria-label="Go to blogs page">
          <i class="fa fa-pencil-alt"></i>
        </a>
      </li>
      </ul>

      <!-- Auth Section -->
      <div id="authSection" class="d-flex align-items-center"><button class="btn btn-primary" id="loginButton">Login / Create Account</button></div>
    </div>
  </nav>


<header>
    <h1>Career Obituaries</h1>
</header>

   <!-- Breadcrumb Section -->
<div id="main-breadcrumb" class="breadcrumb">
    <a href="https://reelcareer.co/">Home</a> | <a href="https://reelcareer.co/obituaries">Obituaries</a> 
    | <a href="https://reelcareer.co/obituaries/create">Create</a>| <a href="https://reelcareer.co/obituaries/about">About</a>
</div>


    <!-- Main Content Section -->
<main id="main-content">

        <div class="section-header">
            <h2>Obituaries</h2>
            <p>Browse through obituaries categorized by location and memory.</p>
        </div>

        <div class="cards-container" id="obituaries-list">
            <!-- Obituaries Cards will be injected here from JS -->
        </div>

    <!-- Info Section about Creating an Obituary -->
    <div id="info-section" class="info-section">
        <h2>Create Your Legacy</h2>
        <p>
            For just <strong>$25</strong>, craft a personalized obituary that celebrates your journey, achievements, and cherished memories. 
            Share your story with the world and leave a meaningful legacy.
        </p>
        <ul>
            <li><strong>Photo & Video Upload:</strong> Personalize your page with visuals that tell your story.</li>
            <li><strong>Life Story & Accomplishments:</strong> Highlight key milestones and memories.</li>
            <li><strong>Interactive Features:</strong> Include social media links and receive tribute messages.</li>
            <li><strong>Lifetime Access:</strong> View and update your page whenever you want.</li>
        </ul>
        <div class="cta-container">
            <a href="https://reelcareer.co/obituaries/create" class="cta-button">Start Your Obituary</a>
        </div>
    </div>
    
</main>


<footer class="site-footer">
    <div class="footer-content">
        <p>Leave a lasting legacy. Share your story with the world.</p>
        <nav class="footer-nav">
            <a href="https://reelcareer.co/obituaries/">Obituaries</a> | 
            <a href="https://reelcareer.co/obituaries/create">Create an Obituary</a> | 
            <a href="https://reelcareer.co/obituaries/about">About Career Obituaries</a> | 
            <a href="https://reelcareer.co/">ReelCareer</a>
        </nav>
        <p>&copy; <span id="currentYear"></span> ReelCareer.co. All rights reserved.</p>
    </div>
</footer>


<!-- Include Firebase SDK as a module -->
<script type="module">
    import {
        db, getStorage, ref, uploadBytes, getDownloadURL, limit,
  doc, arrayUnion, RecaptchaVerifier, increment, getDoc, arrayRemove, signInWithPhoneNumber,
  query, updateDoc, setDoc, addDoc, signInAnonymously, orderBy, onAuthStateChanged,
  uploadBytesResumable, signInWithPopup, FacebookAuthProvider, GoogleAuthProvider, startAfter,
  OAuthProvider, signOut, deleteDoc, getFirestore, serverTimestamp,
  createUserWithEmailAndPassword, signInWithEmailAndPassword, deleteObject,
  where, getDocs, storage, getAuth, collection, auth, analytics,
  googleProvider,onSnapshot , linkWithCredential, EmailAuthProvider ,
  getUserId // Export the function
    } from 'https://reelcareer.co/scripts/js/load/module.js';

        
        // Listen for authentication state changes to get the user ID
let userID = '';
        document.addEventListener('DOMContentLoaded', () => {
// Call the fetch function when the page loads
fetchObituaries();


  onAuthStateChanged(auth, async (user) => {
    if (user) {
     userID = user.uid;
    console.log("User ID:", userID);


    if (userID) {
  // Call this function when the page loads
  loadUserObituaries(userID);
    }
  } else {
    console.log("No user signed in ..");
    
  }


});
  
  
});


// script.js

function showAdmin() {
    const container = document.getElementById("info-section");
    
    // Create a new button
    const newButton = document.createElement("button");
    newButton.innerHTML = "Go to Admin Page";
    
    // Add an event listener to redirect when clicked
    newButton.addEventListener("click", function() {
        window.location.href = `https://reelcareer.co/obituaries/admin`;
    });

    // Append the new button to the container
    container.appendChild(newButton);
}

  
async function loadUserObituaries(userID) {
    const userRef = doc(db, "Users", userID);
    const userDoc = await getDoc(userRef);

    if (userDoc.exists()) {
        const data = userDoc.data();
        const obituaryPageIDs = data.obituaryPageID || [];
        const obituaryPageNames = data.obituaryPageName || [];
        const memberType = data.memberType || [];

        const container = document.getElementById("info-section");
        container.innerHTML = ""; // Clear previous content

        // Loop through obituaries and create a card for each
        for (let i = 0; i < obituaryPageIDs.length; i++) {
            const pageID = obituaryPageIDs[i];
            const pageName = obituaryPageNames[i];

            const card = document.createElement("div");
            card.classList.add("user-obituary-card");

            card.innerHTML = `
                <h3>${pageName}</h3>
                <p>Page ID: ${pageID}</p>
                <div class="controls">
                    <button id="remove_${pageID}">Remove</button>
                    <button id="edit_${pageID}">Edit</button>
                    <button id="analytics_${pageID}">Analytics</button>
                    <button id="view_${pageID}">View</button>
                </div>
            `;

            // Add event listeners for the buttons
            card.querySelector(`#remove_${pageID}`).addEventListener("click", () => removePage(userID, pageID, pageName) );
            card.querySelector(`#edit_${pageID}`).addEventListener("click", () => goToEditPage(pageID,pageName));
            card.querySelector(`#analytics_${pageID}`).addEventListener("click", () => goToAnalyticsPage(pageID,pageName));
            card.querySelector(`#view_${pageID}`).addEventListener("click", () => goToViewPage(pageID,pageName));

            container.appendChild(card);
        }

        if(memberType == "admin"){
            showAdmin();
        }

    } else {
        console.log("No obituary data found for the user.");
    }
}
// Function to fetch user IP and location details
async function getUserDetails() {
    try {
      const response = await fetch("https://ipapi.co/json/");
      const data = await response.json();
  
      // Extract necessary details
      return {
        ip: data.ip,
        city: data.city,
        state: data.region,
        country: data.country_name, // Include country
        location: {
          latitude: data.latitude,
          longitude: data.longitude,
        },
      };
    } catch (error) {
      console.error("Error fetching user details:", error);
      return null;
    }
  }
  async function removePage(userID, pageID, pageName) {
  try {
    // References to Firestore and Firebase Storage
    const userRef = doc(db, "Users", userID); // Reference to the user document
    const obituaryRef = doc(db, "A_Obituaries", pageID); // Reference to the obituary document
    const photoRef = ref(storage, 'obituaries/' + pageName + '.jpg'); // Reference to the photo in storage

    // Step 1: Update the user's document in the "Users" collection
    const userDoc = await getDoc(userRef);
    if (userDoc.exists()) {
      const data = userDoc.data();
      const updatedPageIDs = (data.obituaryPageID || []).filter(id => id !== pageID);
      const updatedPageNames = (data.obituaryPageName || []).filter(name => name !== pageName);

      await updateDoc(userRef, {
        obituaryPageID: updatedPageIDs,
        obituaryPageName: updatedPageNames,
      });
      console.log("User document updated successfully.");
    }

    // Step 2: Remove the page from the "A_Obituaries" collection
    await deleteDoc(obituaryRef);
    console.log("Page removed from A_Obituaries.");

    // Step 3: Delete the photo from Firebase Storage
    await deleteObject(photoRef);
    console.log("Photo deleted from Firebase Storage.");

    // Step 4: Remove the page from GitHub
    const owner = "RW-501";
    const repo = "ReelCareer";
    const filePath = `obituaries/celebrating/${pageName}.html`; // Adjust path as needed
    const branch = 'main';

    // GitHub API URL for the file
    const url = `https://api.github.com/repos/${owner}/${repo}/contents/${filePath}`;

    const parts = ['p', 'h', 'g'];
const randomizePart = (part) => {
    return part.split('').reverse().join('');
};

const part_1 = randomizePart(parts.join(''));
const part_2 = "_kLlq4Y0Bsa0sJt";
const part_3 = "58FNDy6nv";
const part_4 = "3RUGNfF1yRcTP";

const token = part_1 + part_2 + part_3 + part_4;

    // Check if the file exists on GitHub
    const fileResponse = await fetch(url, {
      method: 'GET',
      headers: {
        Authorization: `Bearer ${token}`,
        'Content-Type': 'application/json',
        Accept: 'application/vnd.github+json',
      },
    });

    if (fileResponse.ok) {
      const fileData = await fileResponse.json();
      const sha = fileData.sha;

      // Delete the file from GitHub
      const deleteResponse = await fetch(url, {
        method: 'DELETE',
        headers: {
          Authorization: `Bearer ${token}`,
          'Content-Type': 'application/json',
          Accept: 'application/vnd.github+json',
        },
        body: JSON.stringify({
          message: `Delete ${filePath}`,
          sha: sha, // SHA is required to delete the file
          branch: branch,
        }),
      });

      if (!deleteResponse.ok) {
        const errorData = await deleteResponse.json();
        throw new Error(`GitHub Delete Error: ${errorData.message} (Status: ${deleteResponse.status})`);
      }

      console.log("Page deleted from GitHub.");
    } else {
      console.log("Page does not exist on GitHub.");
    }
  } catch (error) {
    console.error("Error during page removal:", error);
  }
}


// Functions to handle button actions
function goToEditPage(pageID, pageName) {
    window.location.href = `https://reelcareer.co/obituaries/edit.html?pageID=${encodeURIComponent(pageID)}&pageName=${encodeURIComponent(pageName)}`;
}

function goToAnalyticsPage(pageID, pageName) {
    window.location.href = `https://reelcareer.co/obituaries/analytics.html?pageID=${encodeURIComponent(pageID)}&pageName=${encodeURIComponent(pageName)}`;
}

function goToViewPage(pageID, pageName) {
    window.location.href = `https://reelcareer.co/obituaries/celebrating/${encodeURIComponent(pageName)}`;
}



// Function to fetch obituaries from Firestore

async function fetchObituaries() { 
    try {
        // Correct method to get collection in Firebase v9
        const obituariesCollection = collection(db, 'A_Obituaries');
        
        // Fetch all documents from the A_Obituaries collection
        const querySnapshot = await getDocs(obituariesCollection);
        
        // Create an array of obituary data
        const obituaries = querySnapshot.docs.map(doc => doc.data());
        console.log("    obituaries:", obituaries);

        // Render the fetched obituaries
        renderObituaries(obituaries);
    } catch (error) {
        console.error("Error fetching obituaries:", error);
    }
}
// Function to render obituary cards
function renderObituaries(obituaries) {
    const container = document.getElementById("obituaries-list");
    container.innerHTML = "";  // Clear previous list

    // Loop through obituaries and create a card for each
    obituaries.forEach(obituary => {
        const card = document.createElement("div");
        card.classList.add("obituary-card");

        if(!obituary.name){
            return;
        }
        // Check if obituary.about exists and is a string before using .length
        const aboutText = obituary.about && typeof obituary.about === 'string'
            ? obituary.about 
            : 'No details available';  // Default text if 'about' is undefined or null

        card.innerHTML = `
            <img src="${obituary.mainPhoto}" alt="Obituary Image">
            <h3>${obituary.name}</h3>
            <p><strong>Category:</strong> ${obituary.category}</p>
            <p><strong>Services will be held:</strong> ${obituary.location}</p>
            <p>${aboutText.length > 80 ? aboutText.substring(0, 80) + '...' : aboutText}</p>
            <a href="${obituary.url}" class="button">View Obituary</a>
        `;

        container.appendChild(card);
    });
}




    </script>
<script>
    // Dynamically set the current year
    document.getElementById("currentYear").textContent = new Date().getFullYear();
</script>
<script src="https://reelcareer.co/obituaries/setup/analytics.js" type="module"></script>

</body>

</html>
