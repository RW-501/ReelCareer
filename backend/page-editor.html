<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Editor - Admin</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://reelcareer.co/backend/css/styles.css">
        <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    
<!-- Main Script Loader -->
    <script src="https://reelcareer.co/scripts/js/loader.js"></script>

    <style>
        * {
    user-select: auto;
    box-sizing: border-box;
}
.htmlOutput {
    width: 100%;
    min-height: 200px;
}
.tab-switch-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #ccc;
        }
        .switch-tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid #ccc;
            border-bottom: none;
            background: #f1f1f1;
        }
        .switch-tab.active {
            background: #fff;
            font-weight: bold;
        }
        .card.active {
            display: block; /* Show only active tab content */
        }
.tab-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #ccc;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid #ccc;
            border-bottom: none;
            background: #f1f1f1;
        }
        .tab.active {
            background: #fff;
            font-weight: bold;
        }
        .card {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
            display: none;
        }
        .card.collapsed  {
            display: none;
        }

        .collapsed  {
            display: none;
        }

        .collapse-toggle {
            cursor: pointer;
            color: blue;
            text-decoration: underline;
            margin-bottom: 5px;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin-top: 10px;
        }
        .controls {
            margin-top: 10px;
            padding: 10px;
            border-top: 1px solid #ddd;
            background: #f1f1f1;
        }

        #tab-switch-container-area .pageContainer {
            display: none;
        }

        #tab-switch-container-area  .active {
            display: block;
        }
        .area {
            display: block;
        }

       .flex  {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-content: stretch;
    justify-content: space-around;
    align-items: center;
}

.pageCard {
    border: 1px solid #ddd;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 5px;
    background-color: #f9f9f9;
}
.htmlOutput {
    width: 400px;
    max-height: 300px;
    overflow-y: scroll;
    min-height: 50px;
}

#htmlOutputContainer .htmlOutput {
    /* Styles for htmlOutput elements */
    font-family: monospace;
    background-color: #f9f9f9;
}

.contentTag {
    overflow-y: auto;
    height: 100px;
    resize: vertical;
}

details summary {
    cursor: pointer;
    font-weight: bold;
    background-color: #f4f4f4;
    padding: 8px;
    border: 1px solid #ddd;
    border-radius: 4px;
}

details[open] summary {
    background-color: #e2e6ea;
}
    </style>
    </head>

    <body>

    <script defer src="https://reelcareer.co/backend/js/admin.js"></script>

   <!-- Navbar section -->
<nav id="Main_Nav" class="navbar navbar-expand-lg navbar-light bg-light" role="navigation" aria-label="Main Navigation">
  <a class="navbar-brand" href="https://reelcareer.co">ReelCareer.co</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">

                        <!-- Dashboard and New Group -->
                        <div class="navGroup" title="Dashboard and Analytics">
                            <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/notes">Notes</a></li>
                            <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/titles-fix">Title Fix</a></li>
                  </div>

            <!-- Dashboard and Analytics Group -->
            <div class="navGroup" title="Dashboard and Analytics">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/dashboard">Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/analytics">Analytics</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/state-labour-market">State Labour Market</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/ping">Ping</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/page-editor">Page Editor</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/notes">Notes</a></li>
            </div>
            <!-- Management Tools -->
            <div class="navGroup" title="Management Tools">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/content-management">Content <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/user-management">User <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/job-management">Job <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/application-management">Application <small>Management</small></a></li>
            </div>
            <!-- General Settings and Utilities -->
            <div class="navGroup" title="General Settings and Utilities">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/contact">Contact</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/settings">Settings</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/support">Support</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/chatbot">Chatbot</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/notifications-management">Notifications <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/system-logs">System Logs</a></li>
            </div>
            <!-- Finance and Monetization -->
            <div class="navGroup" title="Finance and Monetization">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/transactions">Transactions</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/integration-management">Integration <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/payments">Payments</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/monetization">Monetization</a></li>
            </div>
            <!-- SEO and Cleanup -->
            <div class="navGroup" title="SEO and Cleanup">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/delete-dup">Delete Dup</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/seo-helper">SEO Helper</a></li>
            </div>
            <!-- Role and Personality Management -->
            <div class="navGroup" title="Role and Personality Management">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/role-management">Role <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/trait-personality-management">Trait Personality <small>Management</small></a></li>
            </div>
        </ul>
    </div>
</nav>    
<main id="main-content">

        <!-- Tabs -->
        <div class="tab-switch-container">
            <div class="switch-tab active" data-target="editPageArea">Edit Page Area</div>
            <div class="switch-tab" data-target="newPageArea">New Page Area</div>
        </div>


        <div id="tab-switch-container-area">

<div class="pageContainer mt-4 active"  id="editPageArea">
        <h1>Page Editor</h1>



        <div class="mb-4">
            <div class="card-body">
                <h4>Edit Page</h4>
                <div class="flex">
            <select id="page-url" >
                <option value="" disabled selected>Select a URL</option>
                <option value="https://reelcareer.co/">Home</option>
                <option value="https://reelcareer.co/job-listings">Job Listings</option>
                <option value="https://reelcareer.co/reels">Reels</option>
                <option value="https://reelcareer.co/views/membership">Membership</option>
                <option value="https://reelcareer.co/views/blogs">Blogs</option>
                <option value="https://reelcareer.co/u/">User Dashboard</option>
                <option value="https://reelcareer.co/u/create">Create User</option>
                <option value="https://reelcareer.co/u/messaging">Messaging</option>
                <option value="https://reelcareer.co/u/seeker/">Job Seeker</option>
                <option value="https://reelcareer.co/u/recuiter/">Recruiter</option>
                <option value="https://reelcareer.co/views/about">About</option>
                <option value="https://reelcareer.co/views/contact">Contact</option>
                <option value="https://reelcareer.co/views/privacy">Privacy Policy</option>
                <option value="https://reelcareer.co/views/terms">Terms and Conditions</option>
                <option value="https://reelcareer.co/views/news">News</option>
                <option value="https://reelcareer.co/views/Personality-&-Trait-Tests">Personality & Trait Tests</option>
                <option value="https://reelcareer.co/views/faq">FAQ</option>
                <option value="https://reelcareer.co/bot">Bot</option>
                <option value="https://reelcareer.co/support">Support</option>
                <option value="https://reelcareer.co/views/referral">Referral</option>
                <option value="https://reelcareer.co/jobs/city">Jobs by City</option>
                <option value="https://reelcareer.co/jobs/state">Jobs by State</option>
                <option value="https://reelcareer.co/jobs/locations">Jobs by Locations</option>
                <option value="https://reelcareer.co/views/auth">Auth Page</option>
                <option value="https://reelcareer.co/views/Forgot-Password">Forgot Password</option>
                <option value="https://reelcareer.co/support/getting-started">Support: Getting Started</option>
                <option value="https://reelcareer.co/support/troubleshooting">Support: Troubleshooting</option>
              </select>
              <div class="area">
                <button id="fetch-content" style="margin-top: 10px; padding: 10px;">Fetch Content</button>
              </div>

            </div>
        </div>


  <!-- Tabs -->
  <div class="tab-container">
    <div class="tab active" data-tab="page-html"  data-type="html"  data-content="html-area-content">Page HTML</div>
    <div class="tab" data-tab="page-nav"  data-type="nav" data-content="nav-area-content">Page Nav</div>
    <div class="tab" data-tab="page-head"  data-type="head" data-content="head-area-content">Page Head</div>
    <div class="tab" data-tab="page-main"  data-type="main" data-content="main-area-content">Page Main</div>
    <div class="tab" data-tab="page-footer"  data-type="footer" data-content="footer-area-content">Page Footer</div>
</div>

<div class="container">
<button id="stop-update">Stop</button>
<button id="reset-storage">Reset</button>
<div id="progress-area">
    <p>Content Type: <span id="current-content-type">None</span></p>
    <p>Progress: <span id="progress-tracker">0</span> / <span id="total-count">0</span></p>
</div>
</div>

<!-- Collapsible Sections -->
<div id="page-html" class="pageCard">
    <div class="area-content" id="html-area-content">Toggle Content</div>
    <div class="card-content">
        <label for="extracted-content-html">Page HTML:</label>
        <div id="extracted-content-html" class="htmlOutput"></div>
        <div id="controls-page-html" class="controls">
            <div class='text'> Controls for Page HTML</div>
            <button data-content="html-area-content" class="update-content" style="margin-top: 10px; padding: 10px;">Update Content</button>

            

        </div>
    </div>
</div>

<div id="page-head" class="pageCard collapsed">
    <input type="text" id="searchBar" placeholder="Search meta tags..." />
    <div id="metaTagsContainer">
    <div class="area-content" id="head-area-content">Toggle Content</div>
    </div>
    
    <div class="card-content">
        <label for="extracted-content-head">Page Head:</label>
        <div id="extracted-content-head" class="htmlOutput"></div>
        <div id="controls-page-head" class="controls">
            <div class='text'> Controls for Page Head</div>
            <button data-content="head-area-content"  data-contentType="head" class="update-content" style="margin-top: 10px; padding: 10px;">Update Content</button>
            <button class="auto-update-content" data-contentType="head">Start Auto Update</button>

        </div>
    </div>
</div>

<div id="page-main" class="pageCard collapsed">
    <div class="area-content" id="main-area-content">Toggle Content</div>
    <div class="card-content">
        <label for="extracted-content-main">Page Main:</label>
        <div id="extracted-content-main" class="htmlOutput"></div>
        <div id="controls-page-main" class="controls">
            <div class='text'> Controls for Page Main</div>
            <button data-content="main-area-content"  data-contentType="main" class="update-content" style="margin-top: 10px; padding: 10px;">Update Content</button>
            <button class="auto-update-content" data-contentType="main">Start Auto Update</button>

        </div>
    </div>
</div>

<div id="page-nav" class="pageCard collapsed">
    <div class="area-content" id="nav-area-content">Toggle Content</div>
    <div class="card-content">
        <label for="extracted-content-nav">Page Nav:</label>
        <div id="extracted-content-nav" class="htmlOutput"></div>
        <div id="controls-page-nav" class="controls">
            <div class='text'></div>Controls for Page Nav</div>
            <button data-content="nav-area-content"  data-contentType="nav" class="update-content" style="margin-top: 10px; padding: 10px;">Update Content</button>
            <button class="auto-update-content" data-contentType="nav">Start Auto Update</button>

        </div>
    </div>
</div>

<div id="page-footer" class="pageCard collapsed">
    <div class="area-content" id="footer-area-content">Toggle Content</div>
    <div class="card-content">
        <label for="extracted-content-footer">Page Footer:</label>
        <div id="extracted-content-footer" class="htmlOutput"></div>
        <div id="controls-page-footer" class="controls">
            <div class='text'>Controls for Page Footer</div>
            <button data-content="footer-area-content"  data-contentType="footer" class="update-content" style="margin-top: 10px; padding: 10px;">Update Content</button>
            <button class="auto-update-content" data-contentType="footer">Start Auto Update</button>


        </div>
    </div>
</div>


</div>
<label id='updateContent-label' for="updateContent">Update Content:</label>
<div id="updateContent"></div>
</div>



        <!-- Create New Page Form -->
        <div class="pageContainer  mt-4" id="newPageArea">
            <div class="card-body">
                <h4>Create a New Page</h4>
                <form id="newPageForm">
                    <div class="form-group">
                        <label for="newPageTitle">Page Title</label>
                        <input type="text" class="form-control" id="newPageTitle" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Page</button>
                </form>
            </div>
     
            




        <!-- Tabs for Pages -->
        <ul class="nav nav-tabs" id="pageTabs" role="tablist"></ul>

        <div class="tab-content mt-4" id="pageContent"></div>

        <div id="successMessage" class="mt-4" style="display: none;"></div>
        <div id="errorMessage" class="mt-4 text-danger" style="display: none;"></div>
    </div>

</div>


</main>



    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <!-- Footer -->
    <footer id="dynamic-footer"></footer>
    

    <script>

        let html, head, main, footer, nav;
        let htmlOutputArea, pageUrl;

        document.getElementById('fetch-content').addEventListener('click', async () => {
             pageUrl = document.getElementById('page-url').value;
            htmlOutputArea = document.getElementById('extracted-content-html');


            const headOutputArea = document.getElementById('extracted-content-head');
            const navOutputArea = document.getElementById('extracted-content-nav');
            const mainOutputArea = document.getElementById('extracted-content-main');
            const footerOutputArea = document.getElementById('extracted-content-footer');

            if (!pageUrl) {
                htmlOutputArea.innerText = "Please enter a valid URL.";
                return;
            }

            try {
                // Fetch the HTML content of the provided page URL
                const response = await fetch(pageUrl);
                const htmlText = await response.text();

                // Create a DOM parser to extract elements
                const parser = new DOMParser();
                const doc = parser.parseFromString(htmlText, 'text/html');



                 html = doc.querySelector('html')?.outerHTML || 'No <html> found';


                    const body = doc.querySelector('body')?.outerHTML || 'No <body> found';

                // Extract desired elements
                head = doc.querySelector('head')?.outerHTML || 'No <head> found';
                    nav = doc.querySelector('nav')?.outerHTML || 'No <nav> found';
                        main = doc.querySelector('main')?.outerHTML || 'No <main> found';
                 footer = doc.querySelector('footer')?.outerHTML || 'No <footer> found';


                // Combine and output the extracted content
                const extractedContent = `${html}`;
                htmlOutputArea.innerHTML = extractedContent.trim();


                const extractedNav = `${nav}`;
                navOutputArea.innerText = extractedNav.trim();

                const extractedHead = `${head}`;
                headOutputArea.innerText = extractedHead.trim();

                const extractedMain = `${main}`;
                mainOutputArea.innerText = extractedMain.trim();

                const extractedFooter = `${footer}`;
                footerOutputArea.innerText = extractedFooter.trim();


            } catch (error) {
                console.error(error);
                htmlOutputArea.innerText = "Failed to fetch or process the page. Please check the URL and try again.";
            }
        });









        // Tab switching logic
        document.querySelectorAll('.switch-tab').forEach(tab => {
    tab.addEventListener('click', () => {
        // Remove 'active' class from currently active tab and content
        const activeTab = document.querySelector('.switch-tab.active');
        const activeCard = document.querySelector('.pageContainer.active');

        if (activeTab) activeTab.classList.remove('active');
        if (activeCard) activeCard.classList.remove('active');
        const target = document.getElementById(tab.dataset.target);

      
        // Activate the target container
        if (target) target.classList.add('active');
    });
});



              // Tab switching logic
              document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const activeTab = document.querySelector('.tab.active');
                const activeCard = document.querySelector('.pageCard:not(.collapsed)');
               

                
                if (activeTab) activeTab.classList.remove('active');
                if (activeCard) activeCard.classList.add('collapsed');
                  // Add 'active' class to the clicked tab and corresponding content
     //   tab.classList.add('active');
        const content = document.getElementById(activeTab.dataset.content);

        const type = tab.dataset.type; // Optional type differentiation
        let extractedContent = '';

        // Determine tags to extract based on type
        let tagsToExtract = [];
        let tagType = '';

        if (type === "head") {

           
            const metas = Array.from(htmlOutputArea.querySelectorAll('meta'));
if (metas.length > 0) {
    extractedContent += `

        <details>
            <summary>Meta Content (${metas.length} Tags)</summary>
            ${metas.map((meta, index) => {
                // Get the name, property, or content attribute for the label
                const metaName = meta.getAttribute('name') || meta.getAttribute('property') || 'Unnamed Meta';
                const metaContent = meta.getAttribute('content') || 'No content';
                return `
                    <label for="meta-content-${index}">
                        Meta Tag ${index + 1}: [${metaName}] - Content: "${metaContent}"
                    </label>
                    <textarea id="meta-content-${index}" class="contentTag">
                        ${meta.outerHTML.trim()}
                    </textarea>
                `;
            }).join('<hr>')}
        </details>
        <hr>
    `;
}

// Links
const links = Array.from(htmlOutputArea.querySelectorAll('link'));
if (links.length > 0) {
    extractedContent += `
        <details>
            <summary>Link Content (${links.length} Tags)</summary>
            ${links.map((link, index) => {
                const rel = link.getAttribute('rel') || 'No rel';
                const href = link.getAttribute('href') || 'No href';
                return `
                    <label for="link-content-${index}">
                        Link Tag ${index + 1}: [rel="${rel}"] - href="${href}"
                    </label>
                    <textarea id="link-content-${index}" class="contentTag">
                        ${link.outerHTML.trim()}
                    </textarea>
                `;
            }).join('<hr>')}
        </details>
        <hr>
    `;
}

// Scripts
const scripts = Array.from(htmlOutputArea.querySelectorAll('script'));
if (scripts.length > 0) {
    extractedContent += `
        <details>
            <summary>Script Content (${scripts.length} Tags)</summary>
            ${scripts.map((script, index) => {
                const src = script.getAttribute('src') || 'Inline Script';
                return `
                    <label for="script-content-${index}">
                        Script Tag ${index + 1}: [src="${src}"]
                    </label>
                    <textarea id="script-content-${index}" class="contentTag">
                        ${script.outerHTML.trim()}
                    </textarea>
                `;
            }).join('<hr>')}
        </details>
        <hr>
    `;
}

// Styles
const styles = Array.from(htmlOutputArea.querySelectorAll('style'));
if (styles.length > 0) {
    extractedContent += `
        <details>
            <summary>Style Content (${styles.length} Tags)</summary>
            ${styles.map((styling, index) => {
                return `
                    <label for="style-content-${index}">
                        Style Tag ${index + 1}
                    </label>
                    <textarea id="style-content-${index}" class="contentTag">
                        ${styling.outerHTML.trim()}
                    </textarea>
                `;
            }).join('<hr>')}
        </details>
        <hr>
    `;
}

        } else if (type === "nav") {
            const navTags = Array.from(htmlOutputArea.querySelectorAll('nav'));
            if (navTags.length > 0) {
                tagType = "Nav1 Content";
                extractedContent += `
                    <label for="nav1-content">${tagType}: ${navTags.length} Tag:</label>
                    <textarea id="nav1-content-${navTags.length}" class="contentTag">${navTags[0]?.outerHTML.trim()}</textarea>
                    <hr>
                `;
            }
            if (navTags.length > 1) {
                tagType = "Nav2 Content";
                extractedContent += `
                    <label for="nav2-content">${tagType}: ${navTags.length} Tag:</label>
                    <textarea id="nav2-content-${navTags.length}" class="contentTag">${navTags[1]?.outerHTML.trim()}</textarea>
                    <hr>
                `;
            } else {
                extractedContent += '<label>No second <nav> found</label><hr>';
            }

        } else if (type === "main") {
            const mainTag = htmlOutputArea.querySelector('main');
            if (mainTag) {
                tagType = "Main Content";
                extractedContent += `
                    <label for="main-content">${tagType}: Main Tag:</label>
                    <textarea id="main-content" class="contentTag">${mainTag.outerHTML.trim()}</textarea>
                    <hr>
                `;
            }

        } else if (type === "footer") {
            const footerTag = htmlOutputArea.querySelector('footer');
            if (footerTag) {
                tagType = "Footer Content";
                extractedContent += `
                    <label for="footer-content">${tagType}: Footer Tag:</label>
                    <textarea id="footer-content" class="contentTag">${footerTag.outerHTML.trim()}</textarea>
                    <hr>
                `;
            }
        }


        // Inject the extracted content into the target container
        if (content) content.innerHTML = extractedContent;

                tab.classList.add('active');
                const target = document.getElementById(tab.dataset.tab);
                if (target) target.classList.remove('collapsed');
            });
        });




// Search functionality
document.getElementById('searchBar').addEventListener('input', (event) => {
    const query = event.target.value.toLowerCase();
    const labels = document.querySelectorAll('#metaTagsContainer label');
    labels.forEach(label => {
        label.parentElement.style.display = label.textContent.toLowerCase().includes(query) ? '' : 'none';
    });
});

        // Collapsible toggle logic ????????????????????????????//
        document.querySelectorAll('.collapse-toggle').forEach(toggle => {
            toggle.addEventListener('click', () => {
                const card = toggle.closest('.pageCard');
                if (card) card.classList.toggle('collapsed');
            });
        });




        let isStopped = false;
        
        document.querySelectorAll('.update-content').forEach(button => {
    button.addEventListener('click', () => {
        const contentId = button.dataset.content; // Get data-content value
        const contentTYPE = button.dataset.contenttype;
        const target = document.getElementById(contentId);
        const textareas = target.querySelectorAll(`textarea`); // Query all textareas

        let combinedContent = '';

        // Get values from each textarea and combine them
        textareas.forEach(textarea => {
            combinedContent += textarea.value + '\n'; // Add each value with a newline separator
        });

        document.getElementById("updateContent-label").innerText = `Update ${contentId}:`;
        document.getElementById("updateContent").innerText = combinedContent;

        


        // Log the combined content
        console.log(`Content Type: ${contentTYPE}. \n Content ${contentId} \n${combinedContent}`);

let     sha ;
        let decodedContent;
        const updateHeadTagOnGitHub = (filePath, newHeadContent, token) => {
  // Fetch the current HTML file from GitHub

  let url = `https://api.github.com/repos/RW-501/ReelCareer/contents${filePath}.html`;

  fetch(url, {
  method: "GET",
  headers: {
    "Content-Type": "application/json",
  },
})
  .then(response => {
    if (!response.ok) {
      throw new Error(`HTTP error! Status: ${response.status}`);
    }else{
        isStopped = true;
    }
    return response.json();
  })
  .then(data => {
    console.log("Data fetched successfully:");
     sha = data.sha; // Extract the sha

    if (data.content) {
      const cleanedContent = data.content.replace(/\n/g, ""); // Remove line breaks
       decodedContent = atob(cleanedContent); // Decode Base64 -> String
      console.log("Decoded Content:");
    } else {
        isStopped = true;
      console.error("Error: Content is empty or missing");
    }

    
      // Create a regex to match the <head> section and replace it
        const updatedContent = decodedContent.replace(
  new RegExp(`<${contentTYPE}[^>]*>([\\s\\S]*?)<\\/${contentTYPE}>`),
  `<${contentTYPE}>${newHeadContent}</${contentTYPE}>`
);
      
      // Base64 encode the updated content
      const encodedContent = btoa(updatedContent);

      //const token = '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';

      // Send a PUT request to update the file with the new content
      return fetch(url, {
        method: "PUT",
        headers: {
          //  Authorization: `Bearer ${token}`,
            authorization: `Bearer ${token}`,
            'Content-Type': 'application/json;',
          accept: 'application/vnd.github+json',

        },
        body: JSON.stringify({
            message: `Update ${contentId}`,
          content: encodedContent,
          sha: sha,
        }),
      });
    })
    .then(response => response.json())
    
    .then(updatedData => {
        console.log("updatedData:", updatedData);
        console.log("SHA Value:", sha);
        console.log("token Value:", token);
      console.log("File updated successfully");
    })
    .catch(error => console.error("Error updating file:", error));
};


// Create a URL object
const urlObj = new URL(pageUrl);

// Get the pathname (file path)
const filePath = urlObj.pathname;

console.log("path: ",filePath);  // Output: "/path/to/file.html"

const newHeadContent = combinedContent;  // Your new <head> content
    //const token = "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";
const token = "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";  // Your GitHub Personal Access Token
updateHeadTagOnGitHub(filePath, newHeadContent, token);



    });
});





document.querySelectorAll('.auto-update-content').forEach(button => {
    button.addEventListener('click', async function () {
   
   
    isStopped = false;

    // Get dataset.content-type and save to localStorage
    const contentTYPE = button.dataset.contenttype;
    localStorage.setItem('contentType', contentTYPE);

    // Save textarea value to localStorage
    const updateContentValue = document.getElementById('updateContent').value;
    localStorage.setItem('updateContent', updateContentValue);

    // Get selected page URL and save to localStorage
    const pageUrlSelect = document.getElementById('page-url');
    const pageOptions = Array.from(pageUrlSelect.options);
    const totalCount = pageOptions.length;
    let completedCount = 0;

    document.getElementById('total-count').textContent = totalCount;

    for (let i = 0; i < pageOptions.length; i++) {
        if (isStopped) break;

        // Update progress
        pageUrlSelect.selectedIndex = i;
        localStorage.setItem('pageUrl', pageUrlSelect.value);

        document.getElementById('progress-tracker').textContent = completedCount + 1;
        document.getElementById('current-content-type').textContent = contentTYPE;

        // Simulate fetch-content button clicks
        document.getElementById('fetch-content').click();
        document.getElementById('fetch-content').click();

        await new Promise(resolve => setTimeout(resolve, 2000));

        // Get localStorage values and perform actions
        const storedContentType = localStorage.getItem('contentType');
        const storedContent = localStorage.getItem('updateContent');
        
        // Perform actions based on storedContentType
        const pageButton = document.getElementById(`page-${storedContentType}`);
        if (pageButton) pageButton.click();

        const contentArea = document.getElementById(`content-${storedContentType}`);
        if (contentArea) {
            contentArea.value = storedContent;
        }

        const updateContentButton = document.querySelector(`.update-content[data-content="${storedContentType}-area-content"]`);
        if (updateContentButton) {
            updateContentButton.click();
        }

        await new Promise(resolve => setTimeout(resolve, 2000));

        completedCount++;
    }

    alert("Update Process Completed!");
});

});


// Stop Button Functionality
document.getElementById('stop-update').addEventListener('click', function () {
    isStopped = true;
});

// Reset Button Functionality
document.getElementById('reset-storage').addEventListener('click', function () {
    localStorage.clear();
    document.getElementById('progress-tracker').textContent = '0';
    document.getElementById('current-content-type').textContent = 'None';
    alert("Local storage has been reset.");
});

    </script>
</body>     

    <!-- Firebase JS SDK and Custom Scripts -->

    <script type="module">
        import {
            db, doc, getDoc, query, updateDoc,
            setDoc, ref, signInWithPopup, orderBy,
             
            uploadBytes, OAuthProvider, arrayUnion, getStorage,
            signOut, addDoc, increment, onAuthStateChanged,
            createUserWithEmailAndPassword, signInWithEmailAndPassword,
            where, getDocs, storage, collection, deleteObject, 
            auth, analytics, deleteDoc, getDownloadURL
        } from 'https://reelcareer.co/scripts/js/load/module.js';





        // Initialize Quill rich text editor
        let quills = {}; // Store multiple Quill instances

        function initializeQuill(editorId) {
            quills[editorId] = new Quill(`#${editorId}`, {
                theme: 'snow',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, false] }],
                        ['bold', 'italic', 'underline'],
                        ['image', 'code-block'],
                        ['clean'] // Remove formatting button
                    ]
                }
            });
        }
/*
        // Load all pages and create tabs dynamically
        function loadPages() {
            db.collection('Pages').get().then(querySnapshot => {
                querySnapshot.forEach(doc => {
                    createPageTab(doc.id, doc.data());
                });
            });
        }

        // Create new page tab and form dynamically
        function createPageTab(pageId, pageData = { title: '', content: '' }) {
            const pageTabs = document.getElementById('pageTabs');
            const pageContent = document.getElementById('pageContent');

            // Create Tab
            const tab = document.createElement('li');
            tab.classList.add('nav-item');
            tab.innerHTML = `<a class="nav-link" id="${pageId}-tab" data-toggle="tab" href="#${pageId}" role="tab">${pageData.title || 'New Page'}</a>
                             <button class="btn btn-danger btn-sm ml-2" onclick="deletePage('${pageId}')">Delete</button>`;
            pageTabs.appendChild(tab);

            // Create Page Form Content
            const tabContent = document.createElement('div');
            tabContent.classList.add('tab-pane', 'fade');
            tabContent.id = pageId;
            tabContent.innerHTML = `
                <h2>${pageData.title}</h2>
                <form id="${pageId}Form">
                    <div class="form-group">
                        <label for="${pageId}Title">Title</label>
                        <input type="text" class="form-control" id="${pageId}Title" value="${pageData.title}" required>
                    </div>
                    <div class="form-group">
                        <label for="${pageId}Content">Content</label>
                        <div id="${pageId}Editor" style="height: 200px;"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </form>
            `;
            pageContent.appendChild(tabContent);

            // Initialize Quill Editor for this tab
            initializeQuill(`${pageId}Editor`);

            // Fill Quill Editor with existing content if available
            quills[`${pageId}Editor`].root.innerHTML = pageData.content || '';

            // Handle form submission for this page
            document.getElementById(`${pageId}Form`).onsubmit = function(e) {
                e.preventDefault();
                savePageContent(pageId);
            };
        }

        // Save page content to Firestore
        function savePageContent(pageId) {
            const title = document.getElementById(`${pageId}Title`).value;
            const content = quills[`${pageId}Editor`].root.innerHTML; // Get content from Quill editor

            db.collection('Pages').doc(pageId).set({
                title: title,
                content: content
            }).then(() => {
                showSuccessMessage(`${title} page saved successfully!`);
                updateTabTitle(pageId, title);
            }).catch(error => {
                showErrorMessage(`Error saving ${title} page: ${error}`);
            });
        }

        // Update tab title after saving
        function updateTabTitle(pageId, title) {
            document.getElementById(`${pageId}-tab`).textContent = title;
        }

        // Create new page on form submission
        document.getElementById('newPageForm').onsubmit = function(e) {
            e.preventDefault();
            const newPageTitle = document.getElementById('newPageTitle').value;
            const newPageId = newPageTitle.toLowerCase().replace(/\s+/g, '-'); // Use lowercase title as ID
            createPageTab(newPageId, { title: newPageTitle, content: '' });
            showSuccessMessage(`Page "${newPageTitle}" created successfully!`);
        };

        // Delete page functionality
        function deletePage(pageId) {
            if (confirm(`Are you sure you want to delete the page "${pageId}"?`)) {
                db.collection('Pages').doc(pageId).delete().then(() => {
                    document.getElementById(pageId).remove();
                    document.getElementById(`${pageId}-tab`).remove();
                    showSuccessMessage(`Page "${pageId}" deleted successfully!`);
                }).catch(error => {
                    showErrorMessage(`Error deleting page: ${error}`);
                });
            }
        }

        // Show success message
        function showSuccessMessage(message) {
            const successMessage = document.getElementById('successMessage');
            successMessage.style.display = 'block';
            successMessage.innerText = message;
            setTimeout(() => successMessage.style.display = 'none', 3000);
        }

        // Show error message
        function showErrorMessage(message) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.style.display = 'block';
            errorMessage.innerText = message;
            setTimeout(() => errorMessage.style.display = 'none', 3000);
        }

        // Load pages on page load
        window.onload = loadPages;


        */
    </script>
</body>
</html>
