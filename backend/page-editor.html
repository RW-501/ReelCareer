<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page Editor - Admin</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://reelcareer.co/backend/css/styles.css">
        <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">

    
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    
<!-- Main Script Loader -->
    <script src="https://reelcareer.co/scripts/js/loader.js"></script>
</head>

<body>
    <style>
        * {
    user-select: auto;
    box-sizing: border-box;
}
.htmlOutput {
    width: 100%;
    min-height: 200px;
}

.tab-container {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #ccc;
        }
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            border: 1px solid #ccc;
            border-bottom: none;
            background: #f1f1f1;
        }
        .tab.active {
            background: #fff;
            font-weight: bold;
        }
        .card {
            border: 1px solid #ddd;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 5px;
            background-color: #f9f9f9;
        }
        .card.collapsed .card-content {
            display: none;
        }
        .collapse-toggle {
            cursor: pointer;
            color: blue;
            text-decoration: underline;
            margin-bottom: 5px;
        }
        textarea {
            width: 100%;
            height: 150px;
            margin-top: 10px;
        }
        .controls {
            margin-top: 10px;
            padding: 10px;
            border-top: 1px solid #ddd;
            background: #f1f1f1;
        }
    </style>
    <script defer src="https://reelcareer.co/backend/js/admin.js"></script>

   <!-- Navbar section -->
<nav id="Main_Nav" class="navbar navbar-expand-lg navbar-light bg-light" role="navigation" aria-label="Main Navigation">
  <a class="navbar-brand" href="https://reelcareer.co">ReelCareer.co</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav">

                        <!-- Dashboard and New Group -->
                        <div class="navGroup" title="Dashboard and Analytics">
                            <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/notes">Notes</a></li>
                            <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/titles-fix">Title Fix</a></li>
                  </div>

            <!-- Dashboard and Analytics Group -->
            <div class="navGroup" title="Dashboard and Analytics">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/dashboard">Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/analytics">Analytics</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/state-labour-market">State Labour Market</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/ping">Ping</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/page-editor">Page Editor</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/notes">Notes</a></li>
            </div>
            <!-- Management Tools -->
            <div class="navGroup" title="Management Tools">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/content-management">Content <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/user-management">User <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/job-management">Job <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/application-management">Application <small>Management</small></a></li>
            </div>
            <!-- General Settings and Utilities -->
            <div class="navGroup" title="General Settings and Utilities">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/contact">Contact</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/settings">Settings</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/support">Support</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/chatbot">Chatbot</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/notifications-management">Notifications <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/system-logs">System Logs</a></li>
            </div>
            <!-- Finance and Monetization -->
            <div class="navGroup" title="Finance and Monetization">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/transactions">Transactions</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/integration-management">Integration <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/payments">Payments</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/monetization">Monetization</a></li>
            </div>
            <!-- SEO and Cleanup -->
            <div class="navGroup" title="SEO and Cleanup">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/delete-dup">Delete Dup</a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/seo-helper">SEO Helper</a></li>
            </div>
            <!-- Role and Personality Management -->
            <div class="navGroup" title="Role and Personality Management">
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/role-management">Role <small>Management</small></a></li>
                <li class="nav-item"><a class="nav-link" href="https://reelcareer.co/backend/trait-personality-management">Trait Personality <small>Management</small></a></li>
            </div>
        </ul>
    </div>
</nav>    
<main id="main-content">

        <!-- Tabs -->
        <div class="tab-switch-container">
            <div class="switch-tab active" data-target="newPageArea">New Page Area</div>
            <div class="switch-tab" data-target="editPageArea">Edit Page Area</div>
        </div>



<div class="container mt-4">
        <h1>Page Editor</h1>



        <div class="card mb-4" id="editPageArea">
            <div class="card-body">
                <h4>Edit Page</h4>
                <div class="flex">
            <select id="page-url" >
                <option value="" disabled selected>Select a URL</option>
                <option value="https://reelcareer.co/">Home</option>
                <option value="https://reelcareer.co/job-listings">Job Listings</option>
                <option value="https://reelcareer.co/reels">Reels</option>
                <option value="https://reelcareer.co/views/membership">Membership</option>
                <option value="https://reelcareer.co/views/blogs">Blogs</option>
                <option value="https://reelcareer.co/u/">User Dashboard</option>
                <option value="https://reelcareer.co/u/create">Create User</option>
                <option value="https://reelcareer.co/u/messaging">Messaging</option>
                <option value="https://reelcareer.co/u/seeker/">Job Seeker</option>
                <option value="https://reelcareer.co/u/recuiter/">Recruiter</option>
                <option value="https://reelcareer.co/views/about">About</option>
                <option value="https://reelcareer.co/views/contact">Contact</option>
                <option value="https://reelcareer.co/views/privacy">Privacy Policy</option>
                <option value="https://reelcareer.co/views/terms">Terms and Conditions</option>
                <option value="https://reelcareer.co/views/news">News</option>
                <option value="https://reelcareer.co/views/Personality-&-Trait-Tests">Personality & Trait Tests</option>
                <option value="https://reelcareer.co/views/faq">FAQ</option>
                <option value="https://reelcareer.co/bot">Bot</option>
                <option value="https://reelcareer.co/support">Support</option>
                <option value="https://reelcareer.co/views/referral">Referral</option>
                <option value="https://reelcareer.co/jobs/city">Jobs by City</option>
                <option value="https://reelcareer.co/jobs/state">Jobs by State</option>
                <option value="https://reelcareer.co/jobs/locations">Jobs by Locations</option>
                <option value="https://reelcareer.co/views/auth">Auth Page</option>
                <option value="https://reelcareer.co/views/Forgot-Password">Forgot Password</option>
                <option value="https://reelcareer.co/views/news#">News Section</option>
                <option value="https://reelcareer.co/support/getting-started">Support: Getting Started</option>
                <option value="https://reelcareer.co/support/troubleshooting">Support: Troubleshooting</option>
              </select>
              <div class="container">
                <button id="fetch-content" style="margin-top: 10px; padding: 10px;">Fetch Content</button>
              </div>

            </div>
        </div>


  <!-- Tabs -->
  <div class="tab-container">
    <div class="tab active" data-tab="page-html">Page HTML</div>
    <div class="tab" data-tab="page-head">Page Head</div>
    <div class="tab" data-tab="page-main">Page Main</div>
    <div class="tab" data-tab="page-footer">Page Footer</div>
</div>

<!-- Collapsible Sections -->
<div id="page-html" class="card">
    <div class="collapse-toggle">Toggle Content</div>
    <div class="card-content">
        <label for="extracted-content-html">Page HTML:</label>
        <textarea id="extracted-content-html" class="htmlOutput"></textarea>
        <div id="controls-page-html" class="controls">
            Controls for Page HTML
        </div>
    </div>
</div>

<div id="page-head" class="card collapsed">
    <div class="collapse-toggle">Toggle Content</div>
    <div class="card-content">
        <label for="extracted-content-head">Page Head:</label>
        <textarea id="extracted-content-head" class="htmlOutput"></textarea>
        <div id="controls-page-head" class="controls">
            Controls for Page Head
        </div>
    </div>
</div>

<div id="page-main" class="card collapsed">
    <div class="collapse-toggle">Toggle Content</div>
    <div class="card-content">
        <label for="extracted-content-main">Page Main:</label>
        <textarea id="extracted-content-main" class="htmlOutput"></textarea>
        <div id="controls-page-main" class="controls">
            Controls for Page Main
        </div>
    </div>
</div>

<div id="page-footer" class="card collapsed">
    <div class="collapse-toggle">Toggle Content</div>
    <div class="card-content">
        <label for="extracted-content-footer">Page Footer:</label>
        <textarea id="extracted-content-footer" class="htmlOutput"></textarea>
        <div id="controls-page-footer" class="controls">
            Controls for Page Footer
        </div>
    </div>
</div>


</div>





        <!-- Create New Page Form -->
        <div class="card mb-4" id="newPageArea">
            <div class="card-body">
                <h4>Create a New Page</h4>
                <form id="newPageForm">
                    <div class="form-group">
                        <label for="newPageTitle">Page Title</label>
                        <input type="text" class="form-control" id="newPageTitle" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Create Page</button>
                </form>
            </div>
        </div>




        <!-- Tabs for Pages -->
        <ul class="nav nav-tabs" id="pageTabs" role="tablist"></ul>

        <div class="tab-content mt-4" id="pageContent"></div>

        <div id="successMessage" class="mt-4" style="display: none;"></div>
        <div id="errorMessage" class="mt-4 text-danger" style="display: none;"></div>
    </div>

    
</main>



    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <!-- Footer -->
    <footer id="dynamic-footer"></footer>
    

    <script>
        document.getElementById('fetch-content').addEventListener('click', async () => {
            const pageUrl = document.getElementById('page-url').value;

            const htmlOutputArea = document.getElementById('extracted-content-html');
            const headOutputArea = document.getElementById('extracted-content-head');
            const mainOutputArea = document.getElementById('extracted-content-main');
            const footerOutputArea = document.getElementById('extracted-content-footer');

            if (!pageUrl) {
                htmlOutputArea.value = "Please enter a valid URL.";
                return;
            }

            try {
                // Fetch the HTML content of the provided page URL
                const response = await fetch(pageUrl);
                const htmlText = await response.text();

                // Create a DOM parser to extract elements
                const parser = new DOMParser();
                const doc = parser.parseFromString(htmlText, 'text/html');




                const html = doc.querySelector('html')?.outerHTML || 'No <body> found';



                // Extract desired elements
                const head = doc.querySelector('head')?.outerHTML || 'No <head> found';
                    const main = doc.querySelector('main')?.outerHTML || 'No <main> found';
                        const footer = doc.querySelector('footer')?.outerHTML || 'No <footer> found';



                    const meta = Array.from(doc.querySelectorAll('mata'));

                const navTags = Array.from(doc.querySelectorAll('nav'));
                const nav1 = navTags[0]?.outerHTML || 'No <nav> found';
                const nav2 = navTags[1]?.outerHTML || 'No second <nav> found';


                // Combine and output the extracted content
                const extractedContent = `${html}`;
                htmlOutputArea.value = extractedContent.trim();


                const extractedHead = `${head}`;
                headOutputArea.value = extractedHead.trim();

                const extractedMain = `${main}`;
                mainOutputArea.value = extractedMain.trim();

                const extractedFooter = `${footer}`;
                footerOutputArea.value = extractedFooter.trim();


            } catch (error) {
                console.error(error);
                htmlOutputArea.value = "Failed to fetch or process the page. Please check the URL and try again.";
            }
        });









        // Tab switching logic
        document.querySelectorAll('.switch-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove 'active' class from currently active tab and content
                const activeTab = document.querySelector('.switch-tab.active');
                const activeCard = document.querySelector('.card.active');

                if (activeTab) activeTab.classList.remove('active');
                if (activeCard) activeCard.classList.remove('active');

                // Add 'active' class to the clicked tab and corresponding content
                tab.classList.add('active');
                const target = document.getElementById(tab.dataset.target);
                if (target) target.classList.add('active');
            });
        });


              // Tab switching logic
              document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const activeTab = document.querySelector('.tab.active');
                const activeCard = document.querySelector('.card:not(.collapsed)');
                
                if (activeTab) activeTab.classList.remove('active');
                if (activeCard) activeCard.classList.add('collapsed');
                
                tab.classList.add('active');
                const target = document.getElementById(tab.dataset.tab);
                if (target) target.classList.remove('collapsed');
            });
        });

        // Collapsible toggle logic
        document.querySelectorAll('.collapse-toggle').forEach(toggle => {
            toggle.addEventListener('click', () => {
                const card = toggle.closest('.card');
                if (card) card.classList.toggle('collapsed');
            });
        });
    </script>
</body>     

    <!-- Firebase JS SDK and Custom Scripts -->

    <script type="module">
        import {
            db, doc, getDoc, query, updateDoc,
            setDoc, ref, signInWithPopup, orderBy,
             
            uploadBytes, OAuthProvider, arrayUnion, getStorage,
            signOut, addDoc, increment, onAuthStateChanged,
            createUserWithEmailAndPassword, signInWithEmailAndPassword,
            where, getDocs, storage, collection, deleteObject, 
            auth, analytics, deleteDoc, getDownloadURL
        } from 'https://reelcareer.co/scripts/js/load/module.js';





        // Initialize Quill rich text editor
        let quills = {}; // Store multiple Quill instances

        function initializeQuill(editorId) {
            quills[editorId] = new Quill(`#${editorId}`, {
                theme: 'snow',
                modules: {
                    toolbar: [
                        [{ 'header': [1, 2, false] }],
                        ['bold', 'italic', 'underline'],
                        ['image', 'code-block'],
                        ['clean'] // Remove formatting button
                    ]
                }
            });
        }

        // Load all pages and create tabs dynamically
        function loadPages() {
            db.collection('Pages').get().then(querySnapshot => {
                querySnapshot.forEach(doc => {
                    createPageTab(doc.id, doc.data());
                });
            });
        }

        // Create new page tab and form dynamically
        function createPageTab(pageId, pageData = { title: '', content: '' }) {
            const pageTabs = document.getElementById('pageTabs');
            const pageContent = document.getElementById('pageContent');

            // Create Tab
            const tab = document.createElement('li');
            tab.classList.add('nav-item');
            tab.innerHTML = `<a class="nav-link" id="${pageId}-tab" data-toggle="tab" href="#${pageId}" role="tab">${pageData.title || 'New Page'}</a>
                             <button class="btn btn-danger btn-sm ml-2" onclick="deletePage('${pageId}')">Delete</button>`;
            pageTabs.appendChild(tab);

            // Create Page Form Content
            const tabContent = document.createElement('div');
            tabContent.classList.add('tab-pane', 'fade');
            tabContent.id = pageId;
            tabContent.innerHTML = `
                <h2>${pageData.title}</h2>
                <form id="${pageId}Form">
                    <div class="form-group">
                        <label for="${pageId}Title">Title</label>
                        <input type="text" class="form-control" id="${pageId}Title" value="${pageData.title}" required>
                    </div>
                    <div class="form-group">
                        <label for="${pageId}Content">Content</label>
                        <div id="${pageId}Editor" style="height: 200px;"></div>
                    </div>
                    <button type="submit" class="btn btn-primary">Save Changes</button>
                </form>
            `;
            pageContent.appendChild(tabContent);

            // Initialize Quill Editor for this tab
            initializeQuill(`${pageId}Editor`);

            // Fill Quill Editor with existing content if available
            quills[`${pageId}Editor`].root.innerHTML = pageData.content || '';

            // Handle form submission for this page
            document.getElementById(`${pageId}Form`).onsubmit = function(e) {
                e.preventDefault();
                savePageContent(pageId);
            };
        }

        // Save page content to Firestore
        function savePageContent(pageId) {
            const title = document.getElementById(`${pageId}Title`).value;
            const content = quills[`${pageId}Editor`].root.innerHTML; // Get content from Quill editor

            db.collection('Pages').doc(pageId).set({
                title: title,
                content: content
            }).then(() => {
                showSuccessMessage(`${title} page saved successfully!`);
                updateTabTitle(pageId, title);
            }).catch(error => {
                showErrorMessage(`Error saving ${title} page: ${error}`);
            });
        }

        // Update tab title after saving
        function updateTabTitle(pageId, title) {
            document.getElementById(`${pageId}-tab`).textContent = title;
        }

        // Create new page on form submission
        document.getElementById('newPageForm').onsubmit = function(e) {
            e.preventDefault();
            const newPageTitle = document.getElementById('newPageTitle').value;
            const newPageId = newPageTitle.toLowerCase().replace(/\s+/g, '-'); // Use lowercase title as ID
            createPageTab(newPageId, { title: newPageTitle, content: '' });
            showSuccessMessage(`Page "${newPageTitle}" created successfully!`);
        };

        // Delete page functionality
        function deletePage(pageId) {
            if (confirm(`Are you sure you want to delete the page "${pageId}"?`)) {
                db.collection('Pages').doc(pageId).delete().then(() => {
                    document.getElementById(pageId).remove();
                    document.getElementById(`${pageId}-tab`).remove();
                    showSuccessMessage(`Page "${pageId}" deleted successfully!`);
                }).catch(error => {
                    showErrorMessage(`Error deleting page: ${error}`);
                });
            }
        }

        // Show success message
        function showSuccessMessage(message) {
            const successMessage = document.getElementById('successMessage');
            successMessage.style.display = 'block';
            successMessage.innerText = message;
            setTimeout(() => successMessage.style.display = 'none', 3000);
        }

        // Show error message
        function showErrorMessage(message) {
            const errorMessage = document.getElementById('errorMessage');
            errorMessage.style.display = 'block';
            errorMessage.innerText = message;
            setTimeout(() => errorMessage.style.display = 'none', 3000);
        }

        // Load pages on page load
        window.onload = loadPages;
    </script>
</body>
</html>
