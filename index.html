<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ReelCareer helps job seekers find their dream job with an extensive list of job postings, news, and tips. Start your career journey today.">
    <meta name="keywords" content="jobs, job search, career, job listings, remote jobs, full-time jobs, part-time jobs, job opportunities">
    <meta name="author" content="ReelCareer">
    <meta name="robots" content="index, follow">
    <meta name="language" content="en">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="ReelCareer - Find Your Dream Job">
    <meta property="og:description" content="Explore job listings and career opportunities. Start your journey with ReelCareer today.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://www.reelcareer.co">
    <meta property="og:image" content="/ReelCareer/images/sq_logo_n_BG.png">
    <meta property="og:site_name" content="ReelCareer">
    
    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ReelCareer">
    <meta name="twitter:title" content="ReelCareer - Find Your Dream Job">
    <meta name="twitter:description" content="Browse thousands of job opportunities. Get hired with ReelCareer.">
    <meta name="twitter:image" content="/ReelCareer/images/sq_logo_n_BG_tie_reel.png">

    <!-- Standard Favicon -->
<link rel="icon" type="image/x-icon" href="/ReelCareer/images/favicons/favicon.ico">

<!-- 32x32 Favicon -->
<link rel="icon" type="image/png" sizes="32x32" href="/ReelCareer/images/favicons/favicon-32x32.png">

<!-- 16x16 Favicon -->
<link rel="icon" type="image/png" sizes="16x16" href="/ReelCareer/images/favicons/favicon-16x16.png">

<!-- Apple Touch Icon -->
<link rel="apple-touch-icon" sizes="180x180" href="/ReelCareer/images/favicons/apple-touch-icon.png">

<!-- Android Favicon (192x192) -->
<link rel="icon" type="image/png" sizes="192x192" href="/ReelCareer/images/favicons/android-chrome-192x192.png">

<!-- Chrome Favicon (512x512) -->
<link rel="icon" type="image/png" sizes="512x512" href="/ReelCareer/images/favicons/android-chrome-512x512.png">

    <!-- Schema.org for Job Listings -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "JobPosting",
      "title": "Software Developer",
      "description": "We are looking for a full-time software developer...",
      "hiringOrganization": {
        "@type": "Organization",
        "name": "ReelCareer",
        "sameAs": "https://www.reelcareer.co"
      },
      "jobLocation": {
        "@type": "Place",
        "address": {
          "@type": "PostalAddress",
          "streetAddress": "1234 Career St.",
          "addressLocality": "Dallas",
          "addressRegion": "TX",
          "postalCode": "75001",
          "addressCountry": "US"
        }
      },
      "datePosted": "2024-10-03",
      "employmentType": "Full-time",
      "validThrough": "2024-12-31T23:59:59"
    }
    </script>

    <!-- Schema.org for Organization -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "ReelCareer",
      "url": "https://www.reelcareer.co",
      "logo": "https://www.reelcareer.co/images/favicon.png",
      "sameAs": [
        "https://www.facebook.com/ReelCareer",
        "https://www.linkedin.com/company/reelcareer",
        "https://twitter.com/ReelCareer"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+1-800-555-5555",
        "contactType": "Customer Support",
        "areaServed": "US",
        "availableLanguage": ["English"]
      }
    }
    </script>

    <!-- Schema.org for Breadcrumbs -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "name": "Home",
        "item": "https://www.reelcareer.co/"
      },{
        "@type": "ListItem",
        "position": 2,
        "name": "Job Listings",
        "item": "https://www.reelcareer.co/job-listings"
      }]
    }
    </script>

    <title>ReelCareer - Find Your Dream Job</title>


    <!-- Custom CSS -->
    <link rel="stylesheet" href="public/css/styles.css">

      <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <script src="public/js/scripts.js"></script>
    <script src="public/js/loadScripts.js"></script>

    <style>
        .custom-load-more-btn {
    border-radius: 8px;
    background-color: #3498db;
    font-size: 16px;
    padding: 12px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

.custom-load-more-btn:hover {
    background-color: #2980b9;
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
}

    </style>
</head>


<body>


    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light fixed-top shadow-sm">
        <div class="container">
            <a class="navbar-brand" href="#">ReelCareer</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="views/job-listings.html">Job Listings</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="views/company-pages.html">Company Pages</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="views/job-seeker.html">Job Seeker</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="views/recruiter-dashboard.html">Recruiter Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="views/news.html">News Page</a>
                    </li>
                    <li class="nav-item">
                        <button class="btn btn-primary" onclick="location.href='views/auth.html'">Login / Create Account</button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
    <main>

    <!-- Hero Section -->
    <div class="jumbotron jumbotron-fluid text-center text-white bg-primary mb-0" style="padding-top: 6rem;">
        <div class="container">
            <h1 class="display-4">Find Your Dream Job</h1>
            <p class="lead">Search job listings, apply, and take your career to the next level.</p>
            <form id="jobSearchForm" class="form-inline justify-content-center mt-4">
                <div class="form-group position-relative" style="width: auto;">
                    <input 
                        type="text" 
                        class="form-control mr-2 mb-2 keywordInput job-input" 
                        placeholder="Keywords (e.g., Developer)" 
                        aria-label="Keywords" 
                        id="keywordInput"
                        required
                        oninput="autoSuggest(this.value,'jobSuggestions')"
                        autocomplete="off">
                </div>

                <input id="locationInput" 
                oninput="autoSuggest(this.value,'locationSuggestions')"
                type="text" class="form-control mr-2 mb-2 keywordInput location-input" placeholder="Location (e.g., City)" aria-label="Location" >
                <select id="jobTypeInput" class="form-control mr-2 mb-2" aria-label="Job Type" >
                    <option value="">Job Type</option>
                    <option value="full-time">Full-time</option>
                    <option value="part-time">Part-time</option>
                    <option value="contract">Contract</option>
                    <option value="remote">Remote</option>
                    <option value="hybrid">Hybrid</option>
                    <option value="freelance">Freelance</option>
                </select>
                <div class="form-group">
                    <input 
                        type="text" 
                        class="form-control mr-2 mb-2" 
                        placeholder="Salary Range (e.g., $50,000)" 
                        onkeydown="restrictKeys(event)" 
                        aria-label="Salary Range"
                        id="salaryInput"
                        oninput="formatSalary(this)"
                    >
                </div>
                                <button type="submit" class="btn btn-light mb-2">Search Jobs</button>
            </form>
        </div>
    </div>
   
    <!-- Featured Jobs Section -->
    <div class="container mt-5">
        <h2 class="text-center mb-4">Featured Jobs</h2>
        <div class="row" id="jobListings">
            <!-- Job cards will be dynamically inserted here -->
        </div>
        <div id="loadingIndicator" class="text-center mt-4" style="display:none;">
            <p>Loading job listings...</p>
        </div>
        <div id="errorIndicator" class="text-center mt-4" style="display:none;">
            <p>Error fetching job listings. Please try again later.</p>
        </div>
    </div>

    <!-- Dynamic News Section -->
    <div class="container mt-5">
        <h2 class="text-center mb-4">Latest Career News</h2>
        <div class="row">
            <div class="col-md-4">
                <div class="card mb-4">
                    <img class="card-img-top" src="/ReelCareer/images/rc_text_sm.png" alt="Article 1">
                    <div class="card-body">
                        <h5 class="card-title">Industry Trends in 2024</h5>
                        <p class="card-text">Stay ahead in your career with the latest industry trends and news.</p>
                        <a href="#" class="btn btn-primary">Read More</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card mb-4">
                    <img class="card-img-top" src="/ReelCareer/images/rc_text_sm.png" alt="Article 2">
                    <div class="card-body">
                        <h5 class="card-title">How to Stand Out as a Job Seeker</h5>
                        <p class="card-text">Learn the best strategies for getting noticed by top recruiters.</p>
                        <a href="#" class="btn btn-primary">Read More</a>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card mb-4">
                    <img class="card-img-top" src="/ReelCareer/images/rc_text_sm.png" alt="Article 3">
                    <div class="card-body">
                        <h5 class="card-title">Top Remote Work Opportunities</h5>
                        <p class="card-text">Discover the top remote jobs and what employers are looking for.</p>
                        <a href="#" class="btn btn-primary">Read More</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Call to Action -->
    <div class="container-fluid bg-light py-5 mt-5">
        <div class="container text-center">
            <h2>Ready to take the next step in your career?</h2>
            <p class="lead">Create an account or login now to get started on your job search.</p>
            <button class="btn btn-primary btn-lg" onclick="location.href='views/auth.html'">Create an Account</button>
            <button class="btn btn-outline-primary btn-lg ml-2" onclick="location.href='views/auth.html'">Login</button>
        </div>
    </div>
</main>


    <!-- Footer -->
    <footer id="dynamic-footer"></footer>

    <!-- Firebase configuration/ Login& Out  -->
    <script type="module" src="public/js/main.js"></script> 

    <script type="module">
    import { db, storage, analytics, app  } from './public/js/main.js'; // Adjust the path based on your structure
    import { query, where, orderBy, limit,  collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";


    let lastVisible = null; // To store the last document loaded


// Function to fetch job listings and sponsors
async function fetchJobListings() {
    const jobListingsContainer = document.getElementById('jobListings');
    const loadingIndicator = document.getElementById('loadingIndicator');
    const errorIndicator = document.getElementById('errorIndicator');

    loadingIndicator.style.display = 'block'; // Show loading indicator
    errorIndicator.style.display = 'none'; // Hide error indicator



    let userInterest1, userInterest2, userInterest3;
    let excludedIds = []; // Replace with your actual IDs
    let userInterests = [userInterest1, userInterest2, userInterest3].filter(Boolean); // Ensure userInterests is an array

    try {
        // Create the base query for Jobs
        let jobsQuery = collection(db, 'Jobs');

        // Adding dynamic filters based on userINFO
      //  if (userINFO.city) jobsQuery = query(jobsQuery, where('city', '==', userINFO.city));
      //  if (userINFO.state) jobsQuery = query(jobsQuery, where('state', '==', userINFO.state));
       // if (userInterests.length > 0) jobsQuery = query(jobsQuery, where('tags', 'array-contains-any', userInterests));

        // Exclude specified IDs
       // if (excludedIds.length > 0) jobsQuery = query(jobsQuery, where('id', 'not-in', excludedIds));

        // Common conditions
        jobsQuery = query(jobsQuery, where('status', '==', 'active'));
        jobsQuery = query(jobsQuery, orderBy('createdAt', 'desc'));
        jobsQuery = query(jobsQuery, limit(20)); // Limit results for pagination


/*
        // If we have already loaded jobs, start from the last visible document
        if (lastVisible) {
            jobsQuery = query(jobsQuery, startAfter(lastVisible));
        }
*/


        const jobListingsSnapshot = await getDocs(jobsQuery);
        console.log("jobListingsSnapshot   ",jobListingsSnapshot);
  
        

// Extract jobs from the snapshot
const jobs = jobListingsSnapshot.docs.map(doc => ({
    id: doc.id, // Get the document ID
    ...doc.data() // Spread the rest of the document data
}));

// Create a new array to store unique jobs
const jobListings = [];

// Use a Set to track job titles we've already seen
const seenTitles = new Set();


// Filter the jobs to ensure no duplicate titles
jobs.forEach(job => {
        
    if (!seenTitles.has(job.title)) {

        jobListings.push({
            id: job.id, // Job document ID
            title: job.title,
            type: job.type,
            description: job.description,
            company: job.company,
            location: job.location,
            salary: job.salary,
        });
        seenTitles.add(job.title); // Mark title as seen
    }
});

// Check if we have any results
if (!jobListingsSnapshot.empty) {
    // Update the last visible document for pagination
    lastVisible = jobListingsSnapshot.docs[jobListingsSnapshot.docs.length - 1];

    // Handle unique job listings and render them
    jobListings.forEach(job => createJobCard(job, jobListingsContainer));
    /*
    console.log("Listing lenght", jobListings.length);
    console.log("jobs lenght", jobs.length);
    console.log("Listing lenght", jobListings.length);
    console.log("seenTitles:", seenTitles);
    */
} else {
    console.log("No jobs found or no more jobs to load.");
}

        // Sponsor logic
        const sponsors = await fetchSponsors(excludedIds);
        addSponsorSection(sponsors, jobListingsContainer);

        // Add "Load More" button for Pagination if jobs are available
            const loadMoreButton = createLoadMoreButton(() => fetchJobListings());
            jobListingsContainer.appendChild(loadMoreButton);
        

    } catch (error) {
        console.error("Error fetching job listings: ", error);
        errorIndicator.style.display = 'block'; // Show error indicator
    } finally {
        loadingIndicator.style.display = 'none'; // Hide loading indicator
    }
}

// Function to create a job card and append it to the container
function createJobCard(job, container) {
    const jobCard = document.createElement('div');
    jobCard.className = 'col-md-4 mb-4';
    jobCard.innerHTML = `
        <div class="card jobCard h-100 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">${job.title}</h5>
                <p class="card-text"><strong>${job.company}</strong></p>
<p class="card-text">
  ${formatLocation(job.location, { part: 'city' })}, ${formatLocation(job.location, { part: 'state' })}
     </p>
                     <p class="card-text"><strong>Type:</strong> ${formatJobType(job.type)}</p>
                     <p class="card-text"><strong>Salary:</strong> ${formatCurrency(job.salary)}</p>
                <a href="views/job-detail.html?id=${job.id}" class="btn btn-primary w-100 mt-3">View Details</a>
            </div>
        </div>
    `;
    container.appendChild(jobCard);
}

// Function to create and return the Load More button
function createLoadMoreButton(loadMoreFunc) { 
    console.log("createLoadMoreButton");
    const loadMoreButton = document.createElement('button');
    loadMoreButton.className = 'btn btn-primary w-100 mt-4';
    loadMoreButton.innerText = 'Load More Jobs';

    // Set initial styles
    loadMoreButton.style.transition = 'opacity 0.5s ease';
    loadMoreButton.style.display = 'block';  // Ensure button is set to display block initially
    loadMoreButton.style.opacity = 1;  // Ensure the opacity is fully visible

    // Modify the onclick event
    loadMoreButton.onclick = () => {
        loadMoreFunc().then(() => {
            console.log("createLoadMoreButton onclick");
        }).catch(() => {
            console.error('Failed to load jobs');
        });
        
        // Hide the button after jobs are loaded
        setTimeout(() => {
            console.log("setTimeout");
            // Apply fade-out effect
            loadMoreButton.style.opacity = 0;
            loadMoreButton.style.display = 'none'; // Hide after fade-out
        }, 500); // Match the duration of the fade-out (500ms)
    };

    // Append the button to the desired container
    const container = document.getElementById('jobListings'); // Change to your container's ID
    if (container) {
        container.appendChild(loadMoreButton); // Add button to the DOM
    } else {
        console.error('Container for jobs not found');
    }

    return loadMoreButton;
}

// Fetch sponsors and handle their display
async function fetchSponsors(excludedIds) {
    let sponsorsQuery = query(collection(db, 'Jobs'));

    // Adding filters for sponsors
    if (userINFO.state) sponsorsQuery = query(sponsorsQuery, where('state', '==', userINFO.state));
    if (userINFO.country) sponsorsQuery = query(sponsorsQuery, where('country', '==', userINFO.country));

    // Exclude IDs
 //   if (excludedIds.length > 0) sponsorsQuery = query(sponsorsQuery, where('id', 'not-in', excludedIds));

    // Filter by status and boost
    sponsorsQuery = query(sponsorsQuery, where('status', '==', 'active'), where('boosted', 'in', ['Yes', 'Active']));
    sponsorsQuery = query(sponsorsQuery, orderBy('createdAt', 'desc'), limit(20));

    const sponsorsSnapshot = await getDocs(sponsorsQuery);
    return sponsorsSnapshot.docs.map(doc => ({
    id: doc.id,
    name: doc.data().title,
    company: doc.data().company,
    logoUrl: doc.data().logo,
    website: doc.data().website,
    // Add any other specific fields you want to include...
}));

}

// Function to add sponsor section to the container
function addSponsorSection(sponsors, container) {
    if (sponsors.length > 0) {
        const sponsorSection = document.createElement('div');
        sponsorSection.className = 'col-12 mt-4';
        sponsorSection.innerHTML = `
            <h5 class="text-center mb-4">Our Sponsors</h5>
            <div class="sponsorArea row">
                ${sponsors.map(sponsor => `
                    <div class="col-md-4">
                        <div class="card sponsorCard h-100 shadow-sm">
                            <img class="card-img-top" src="${sponsor.logoUrl || '/ReelCareer/images/favicons/android-chrome-512x512.png'}" alt="${sponsor.name}">
                            <div class="card-body">
                                <h6 class="card-title">${sponsor.name}</h6>
                                <h4 class="card-text">${sponsor.company}</h4>
                <p class="card-text"><strong>Salary:</strong> $${sponsor.salary}</p>
                <a href="views/job-detail.html?id=${sponsor.id}" class="btn btn-primary w-100 mt-3">Apply Now</a>                            </div>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;
        container.appendChild(sponsorSection);
    }
}






        
       // Load job listings on page load
       fetchJobListings();

        document.getElementById('jobSearchForm').addEventListener('submit', function(event) { 
        event.preventDefault(); // Prevent the default form submission

        // Get the values from the input fields
        const keywords = document.getElementById('keywordInput').value.trim();
        const location = document.getElementById('locationInput').value.trim();
        const jobType = document.getElementById('jobTypeInput').value;
        const salaryRange = document.getElementById('salaryInput').value.trim();

        // Construct the query parameters
        const queryParams = new URLSearchParams({
            keywords: keywords,
            location: location,
            jobType: jobType,
            salaryRange: salaryRange
        }).toString();

        // Navigate to the job listings page with the search parameters
        window.location.href = `./views/job-listings?${queryParams}`;

    });



        </script>
        

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<script>
     

</script>
</body>

</html>