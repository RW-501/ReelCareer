<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Explore a wide range of job opportunities and apply directly through ReelCareer. Search for full-time, part-time, remote, and contract jobs tailored to your career needs.">
    <meta name="keywords" content="job search, career opportunities, full-time jobs, part-time jobs, remote jobs, contract jobs, apply for jobs, career growth, hiring">
    <meta name="robots" content="index, follow">
    <title>ReelCareer - Job Listings</title>

    <!-- Open Graph Tags -->
    <meta property="og:title" content="ReelCareer - Job Listings">
    <meta property="og:description" content="Find your next job opportunity with ReelCareer. Browse a variety of job listings tailored to your skills and preferences.">
    <meta property="og:image" content="https://www.reelcareer.co/images/logo.png">
    <meta property="og:url" content="https://www.reelcareer.co/job-listings.html">
    <meta property="og:type" content="website">

    <!-- Twitter Card Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ReelCareer - Job Listings">
    <meta name="twitter:description" content="Explore a range of job opportunities and apply directly through ReelCareer. Your next career move is just a search away.">
    <meta name="twitter:image" content="https://www.reelcareer.co/images/logo.png">


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

       <!-- Bootstrap CSS -->
       <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
   
  
       
    
    <!-- Bootstrap CSS -->
    <script src="../public/js/scripts.js"></script>
    <script src="../public/js/loadScripts.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../public/css/styles.css">

</head>


<body>
    <script src="../public/js/bodyload.js"></script>
    

<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm">
    <div class="container">
        <a class="navbar-brand" href="../index.html">ReelCareer</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
                <li class="nav-item"><a class="nav-link" href="job-listings.html">Job Listings</a></li>
                <li class="nav-item"><a class="nav-link" href="company-pages.html">Company Pages</a></li>
                <li class="nav-item"><a class="nav-link" href="job-seeker.html">Job Seeker</a></li>
                <li class="nav-item"><a class="nav-link" href="recruiter-dashboard.html">Recruiter Dashboard</a></li>
                <li class="nav-item"><a class="nav-link" href="news.html">News</a></li>
            </ul>
        </div>
    </div>
</nav>

<!-- Job Search Section -->
 <searchArea>
<div class="container mt-5">
    <div class="row">
        <div class="col-md-12 text-center">
            <h1 class="font-weight-bold">Find Your Next Opportunity</h1>
            <p class="lead text-muted">Search from thousands of jobs that fit your skills and preferences</p>
            <form id="jobSearchForm" class="form-inline justify-content-center mt-4">
                <div class="form-group position-relative" style="width: auto;">
                    <input 
                        type="text" 
                        class="form-control form-control-lg mr-2 mb-2 keywordInput job-input" 
                        placeholder="Keywords (e.g., Developer)" 
                        aria-label="Keywords" 
                        id="keywordInput"
                        required
                        oninput="autoSuggest(this.value,'jobSuggestions')"
                        autocomplete="off"
                    >
                </div>

                <input id="locationInput" type="text"
                oninput="autoSuggest(this.value,'locationSuggestions')"
                 class="form-control form-control-lg mr-2 mb-2 keywordInput location-input" placeholder="Location (e.g., City)" >
                <select id="jobTypeInput" class="form-control form-control-lg " style="
                padding: 0.7rem;
            ">
                    <option value="" disabled selected>Job Type</option>
                    <option value="">Job Type</option>
                    <option value="full-time">Full-time</option>
                    <option value="part-time">Part-time</option>
                    <option value="contract">Contract</option>
                    <option value="remote">Remote</option>
                    <option value="hybrid">Hybrid</option>
                    <option value="freelance">Freelance</option>
                </select>
                <div class="form-group">
                    <input 
                        type="text" 
                        class="form-control form-control-lg mr-2 mb-2" 
                        placeholder="Salary Range (e.g., $50,000)" 
                        onkeydown="restrictKeys(event)" 
                        aria-label="Salary Range" 
                        id="salaryInput"
                        oninput="updateCurrency(this)">
                </div>
        <button type="submit" class="btn btn-primary btn-lg mb-2 px-4" onclick="searchJobs();">Search Jobs</button>
            </form>
        </div>
    </div>
</div>
</searchArea>
<div class="container mt-5">
    <h2 class="mb-4 text-center">Job Search Filters</h2>
    
    <!-- Toggle Button for Collapse -->
    <div class="d-flex justify-content-center mb-3">
        <button class="btn btn-outline-primary" type="button" data-bs-toggle="collapse" data-bs-target="#filterSection" aria-expanded="false" aria-controls="filterSection">
            Show Filters
        </button>
    </div>

    <!-- Filter Section (Initially Collapsed) -->
    <div class="collapse" id="filterSection">
        <div class="card shadow-sm p-4">
        <div class="row">



            <div class="w-100"><hr class="my-3"></div>

            <!-- Location -->
            <div class="col-md-4 mb-3">
                <label for="jobLocation" class="form-label ">Location</label>
                <input type="text"
                oninput="autoSuggest(this.value,'locationSuggestions')"
                 class="form-control keywordInput location-input" id="jobLocation" placeholder="City, State or ZIP" data-bs-toggle="tooltip" title="Where do you want to work?">
                <small class="form-text text-muted">Provide a specific location or leave blank for remote jobs.</small>
            </div>

            <!-- City -->
            <div class="col-md-4 mb-3">
                <label for="jobCity" class="form-label ">City</label>
                <input type="text" 
                oninput="autoSuggest(this.value,'citySuggestions')"
                class="form-control keywordInput city-input" id="jobCity" placeholder="City">
                <small class="form-text text-muted">Enter the city where you want to find jobs.</small>
            </div>

            <!-- State -->
            <div class="col-md-4 mb-3">
                <label for="jobState" class="form-label">State</label>
                <input type="text" 
                oninput="autoSuggest(this.value,'stateSuggestions')"
                class="form-control  keywordInput state-input" id="jobState" placeholder="State">
                <small class="form-text text-muted">Enter the state abbreviation (e.g., TX for Texas).</small>
            </div>

            <div class="w-100"><hr class="my-3"></div>

            <!-- Zip Code -->
            <div class="col-md-4 mb-3">
                <label for="jobZip" class="form-label">Zip Code</label>
                <input type="text" class="form-control" id="jobZip" placeholder="Zip Code" data-bs-toggle="tooltip" title="Enter a 5-digit ZIP code.">
                <small class="form-text text-muted">Provide a ZIP code for precise location filtering.</small>
            </div>

            <!-- Salary Range -->
            <div class="col-md-4 mb-3">
                <label for="salaryMin" class="form-label">Minimum Salary</label>
                <input type="text"    onkeydown="restrictKeys(event)" 
                oninput="updateCurrency(this)" aria-label="Minimum Salary" class="form-control" id="salaryMin" placeholder="Minimum Salary" data-bs-toggle="tooltip" title="Enter your desired minimum salary." onkeydown="restrictKeys(event)" oninput="formatCurrency(this)">
                <small class="form-text text-muted">Leave blank if no minimum salary is required.</small>
            </div>

            <div class="col-md-4 mb-3">
                <label for="salaryMax" class="form-label">Maximum Salary</label>
                <input type="text"    onkeydown="restrictKeys(event)" 
                oninput="updateCurrency(this)"  class="form-control" id="salaryMax" placeholder="Maximum Salary" data-bs-toggle="tooltip" title="Enter your desired maximum salary." onkeydown="restrictKeys(event)" oninput="formatCurrency(this)">
                <small class="form-text text-muted">Leave blank if no maximum salary is required.</small>
            </div>

            <div class="w-100"><hr class="my-3"></div>

<!-- Contract Type -->
<div class="col-md-4 mb-3">
    <label for="contractType" class="form-label">Contract Type</label>
    <select class="form-select" id="contractType">
        <option value="">Job Type</option>
        <option value="full-time">Full-time</option>
        <option value="part-time">Part-time</option>
        <option value="contract">Contract</option>
        <option value="remote">Remote</option>
        <option value="hybrid">Hybrid</option>
        <option value="freelance">Freelance</option>
    </select>
    <small class="form-text text-muted">Select the type of job contract you're interested in.</small>
</div>

<!-- Industry Dropdown -->
<div class="col-md-4 mb-3">
    <label for="industry" class="form-label">Industry</label>
    <select class="form-select" id="industry">
        <option value="">Select an Industry</option>
        <option value="Technology">Technology</option>
        <option value="Healthcare">Healthcare</option>
        <option value="Finance">Finance</option>
        <option value="Education">Education</option>
        <option value="Retail">Retail</option>
        <option value="Manufacturing">Manufacturing</option>
        <option value="Hospitality">Hospitality</option>
        <option value="Construction">Construction</option>
        <option value="Transportation">Transportation</option>
        <option value="Real Estate">Real Estate</option>
        <option value="Telecommunications">Telecommunications</option>
        <option value="Entertainment">Entertainment</option>
        <option value="Non-Profit">Non-Profit</option>
        <option value="Government">Government</option>
        <option value="Agriculture">Agriculture</option>
        <option value="Other">Other</option>
    </select>
    <small class="form-text text-muted">Choose an industry to filter jobs.</small>
</div>

<!-- Job Preferences -->
<div class="col-md-4 mb-3">
    <label class="form-label">Job Preferences</label>
    <div class="form-check">
        <input class="form-check-input" type="checkbox" value="immediateHire" id="immediateHire">
        <label class="form-check-label" for="immediateHire">Immediate Hire</label>
    </div>
    <div class="form-check">
        <input class="form-check-input" type="checkbox" value="contractToHire" id="contractToHire">
        <label class="form-check-label" for="contractToHire">Contract to Hire</label>
    </div>
    <small class="form-text text-muted">Select any additional job preferences.</small>
</div>
</div>

<div class="w-100"><hr class="my-3"></div>

<div class="row mb-4">
<!-- Job Posting Date -->
<div class="col-md-4 mb-3">
    <label for="postingDate" class="form-label">Job Posting Date</label>
    <select class="form-select" id="postingDate">
        <option value="">Any Date</option>
        <option value="24h">Last 24 Hours</option>
        <option value="week">Last Week</option>
        <option value="month">Last Month</option>
    </select>
    <small class="form-text text-muted">Filter jobs by when they were posted.</small>
</div>

<!-- Education Level -->
<div class="col-md-4 mb-3">
    <label for="education" class="form-label">Education Level</label>
    <select id="education" class="form-select">
        <option value="highSchool">High School</option>
        <option value="associateDegree">Associate Degree</option>
        <option value="bachelorDegree">Bachelor's Degree</option>
        <option value="masterDegree">Master's Degree</option>
        <option value="phd">PhD</option>
    </select>
    <small class="form-text text-muted">Select your highest education level.</small>
</div>

<!-- Years of Experience -->
<div class="col-md-4 mb-3">
    <label for="experience" class="form-label">Years of Experience <small class="text-muted">(Optional)</small></label>
    <select id="experience" class="form-select">
        <option value="0-1">0-1 years</option>
        <option value="2-5">2-5 years</option>
        <option value="6-10">6-10 years</option>
        <option value="10+">10+ years</option>
    </select>
    <small class="form-text text-muted">Select your relevant years of experience.</small>
 </div>

            <div class="w-100"><hr class="my-3"></div>

            <!-- Job Requirements -->
            <div class="col-md-4 mb-3">
                <label for="jobRequirements" class="form-label  ">Job Requirements</label>
                <textarea
                oninput="autoSuggest(this.value, 'RequirementsSuggestions')"
                class="form-control keywordInput"
                id="jobRequirements"
                rows="2"
                placeholder="e.g. Java, Python, leadership skills, teamwork, communication"
                data-bs-toggle="tooltip"
                title="Enter skills or technologies required for the job. Example: Java, Python, teamwork, leadership">
            </textarea>
            
                <small class="form-text text-muted">Enter relevant job requirements separated by commas.</small>
            </div>



        <!-- Clear Filters Button --> 
        <div class="d-flex  ">
            <div class="justify-content-center ml-auto">
            <button class="btn btn-secondary col-auto" type="reset">Clear Filters</button>
            <button class="btn btn-primary col-auto" onclick="searchJobs();" type="submit" id="searchButton">Search Jobs</button>
            </div>
        </div>
        
    </div>
</div>
</div>

<script>
    /*
    // Enable Bootstrap tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    });
*/
  // Toggle button text change
  document.querySelector('[data-bs-toggle="collapse"]').addEventListener('click', function() {
        const button = this;
        const isCollapsed = button.getAttribute('aria-expanded') === 'true';
        button.textContent = isCollapsed ? 'Show Filters' : 'Hide Filters';
      //  console.log("Button clicked. Current state: ", button.textContent);
    });

    // Save filters to local storage
    document.getElementById('searchButton').addEventListener('click', function() {
        const filters = {
            jobRequirements: document.getElementById('jobRequirements').value,
            jobLocation: document.getElementById('jobLocation').value,
            jobCity: document.getElementById('jobCity').value,
            jobState: document.getElementById('jobState').value,
            jobZip: document.getElementById('jobZip').value,
            salaryMin: document.getElementById('salaryMin').value,
            salaryMax: document.getElementById('salaryMax').value,
            contractType: document.getElementById('contractType').value,
            immediateHire: document.getElementById('immediateHire').checked,
            contractToHire: document.getElementById('contractToHire').checked,
            postingDate: document.getElementById('postingDate').value,
            education: Array.from(document.getElementById('education').selectedOptions).map(option => option.value),
            experience: Array.from(document.getElementById('experience').selectedOptions).map(option => option.value),
            industry: document.getElementById('industry').value,
        };

        localStorage.setItem('jobSearchFilters', JSON.stringify(filters));
      //  alert("Filters saved!");
    });

    // Load saved filters on page load
    window.onload = function() {
        const savedFilters = JSON.parse(localStorage.getItem('jobSearchFilters'));
        if (savedFilters) {
            document.getElementById('jobRequirements').value = savedFilters.jobRequirements || '';
            document.getElementById('jobLocation').value = savedFilters.jobLocation || '';
            document.getElementById('jobCity').value = savedFilters.jobCity || '';
            document.getElementById('jobState').value = savedFilters.jobState || '';
            document.getElementById('jobZip').value = savedFilters.jobZip || '';
            document.getElementById('salaryMin').value = savedFilters.salaryMin || '';
            document.getElementById('salaryMax').value = savedFilters.salaryMax || '';
            document.getElementById('contractType').value = savedFilters.contractType || '';
            document.getElementById('immediateHire').checked = savedFilters.immediateHire || false;
            document.getElementById('contractToHire').checked = savedFilters.contractToHire || false;
            document.getElementById('postingDate').value = savedFilters.postingDate || '';
            if (savedFilters.education) {
                Array.from(document.getElementById('education').options).forEach(option => {
                    option.selected = savedFilters.education.includes(option.value);
                });
            }
            if (savedFilters.experience) {
                Array.from(document.getElementById('experience').options).forEach(option => {
                    option.selected = savedFilters.experience.includes(option.value);
                });
            }
            document.getElementById('industry').value = savedFilters.industry || '';
        }
    };
</script>








<!-- Featured Jobs Section -->
<div class="container mt-5">
    <h2 class="text-center font-weight-bold">Featured Jobs</h2>
    <p class="text-center text-muted">Handpicked job opportunities from top companies</p>
    
    <div class="row" id="featuredJobListings">
        <!-- Featured jobs dynamically inserted here -->
        
        <!-- Message when no featured jobs are available -->
        <div class="col-12 text-center mt-4" id="noFeaturedJobs" style="display: none;">
            <div class="alert alert-warning" role="alert">
                <h4 class="alert-heading">No Featured Jobs Available</h4>
                <p>Currently, there are no featured job opportunities. However, you can still explore other available positions and enhance your visibility!</p>
                <p>We recommend considering a boosted job post to attract more candidates.</p>
                <hr>
                <p class="mb-0">Looking for ideas? Here are some suggested job titles you might consider:</p>
                <ul class="list-unstyled mt-3">
                    <li>Data Analyst</li>
                    <li>Software Developer</li>
                    <li>UI/UX Designer</li>
                    <li>Project Manager</li>
                    <li>Marketing Specialist</li>
                </ul>
                <a href="create-boosted-job.html" class="btn btn-primary mt-3">Create a Boosted Job</a>
            </div>
        </div>
    </div>
</div>


<!-- All Job Listings Section -->
<div class="container mt-5">
    <h2 class="text-center font-weight-bold">All Jobs</h2>
    <div class="row" id="jobListings">
        <!-- Job listings dynamically inserted here -->
    </div>
    <div id="loadingIndicator" class="text-center mt-4" style="display:none;">
        <div class="spinner-border text-primary" role="status">
            <span class="sr-only">Loading...</span>
        </div>
    </div>
</div>

<!-- Pagination -->
<div class="container text-center mt-5">
    <nav>
        <ul class="pagination justify-content-center" id="pagination">
            <!-- Pagination dynamically generated -->
        </ul>
    </nav>
</div>
</div>


<style>

  
    searchArea .form-control {
        border-radius: 50px;
        padding: 15px 20px;
    }
    searchArea .btn-primary {
        border-radius: 50px;
        padding: 12px 30px;
        font-size: 1rem;
    }



    .pagination .page-item.active .page-link {
        background-color: #2980b9;
        border-color: #2980b9;
    }

</style>

   
<script>
       
 

    // Function to redirect user to the job details page with job ID in the URL
function showJobDetailsFunc(jobId) {
    // Construct the URL with the job ID as a query parameter
    const jobDetailsUrl = `../views/job-detail.html?id=${jobId}`;
    
    // Redirect to the job details page
    window.location.href = jobDetailsUrl;
}
</script>


    <!-- Footer -->
    <footer id="dynamic-footer"></footer>
    
    <!-- Firebase configuration/ Login& Out -->
    <script type="module" src="../public/js/main.js"></script> 

    <!-- Dynamic Schema Markup -->
    <script type="module">
    import { db, storage, analytics, app, auth  } from '../public/js/main.js'; // Adjust the path based on your structure
    import { query, where, orderBy, limit,  collection, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";


    let lastVisible = null; // To store the last document loaded

let userInterests = [];
let excludedIds = []; // Replace with your actual IDs

// Assuming userInterest1, userInterest2, userInterest3 are defined elsewhere
let userInterest1, userInterest2, userInterest3; 
userInterests = [userInterest1, userInterest2, userInterest3].filter(Boolean); // Filter out any undefined values

// Function to fetch job listings from Firestore
async function fetchJobListings() {
    // Create the base query for Jobs
    let jobsQuery = query(collection(db, 'Jobs'));

    // Adding dynamic filters based on userINFO
    if (userINFO.city) { 
      //  jobsQuery = query(jobsQuery, where('city', '==', userINFO.city));
    }
    if (userINFO.state) {
   //     jobsQuery = query(jobsQuery, where('state', '==', userINFO.state));
    }
    if (userInterests.length > 0) {
    //    jobsQuery = query(jobsQuery, where('tags', 'array-contains-any', userInterests));
    }

    // Exclude specified IDs if any
    if (excludedIds.length > 0) {
  //      jobsQuery = query(jobsQuery, where('id', 'not-in', excludedIds));
    }

    // Common conditions
    jobsQuery = query(jobsQuery, where('status', '==', 'active'));
    jobsQuery = query(jobsQuery, orderBy('createdAt', 'desc'));
    jobsQuery = query(jobsQuery, limit(20)); // Limit the results

    // Base query for Sponsors
    let sponsorsQuery = query(collection(db, 'Jobs'));

    // Adding dynamic filters based on userINFO for sponsors
    if (userINFO.state) {
      //  sponsorsQuery = query(sponsorsQuery, where('state', '==', userINFO.state));
    }
    if (userINFO.country) {
      //  sponsorsQuery = query(sponsorsQuery, where('country', '==', userINFO.country));
    }
    if (userInterests.length > 0) {
       // sponsorsQuery = query(sponsorsQuery, where('tags', 'array-contains-any', userInterests));
    }

    // Exclude specified IDs for sponsors if necessary
    if (excludedIds.length > 0) {
    //    sponsorsQuery = query(sponsorsQuery, where('id', 'not-in', excludedIds));
    }

    // Common conditions for sponsors
    sponsorsQuery = query(sponsorsQuery, where('status', '==', 'active'), where('boosted', 'in', ['Yes', 'Active']));
    sponsorsQuery = query(sponsorsQuery, orderBy('createdAt', 'desc'));
    sponsorsQuery = query(sponsorsQuery, limit(20)); // Limit the results

    try {
        // Fetch job listings and sponsors
        const jobListingsSnapshot = await getDocs(jobsQuery);
        const sponsorsSnapshot = await getDocs(sponsorsQuery);
 
        

// Extract jobs from the snapshot
const jobs = jobListingsSnapshot.docs.map(doc => ({
    id: doc.id, // Get the document ID
    ...doc.data() // Spread the rest of the document data
}));

// Create a new array to store unique jobs
const jobListings = [];

// Use a Set to track job titles we've already seen
const seenTitles = new Set();

// Filter the jobs to ensure no duplicate titles
jobs.forEach(job => {
    if (!seenTitles.has(job.title)) {

        jobListings.push({
            id: job.id, // Job document ID
                title: job.title,
                description: job.description,
                datePosted: job.createdAt,
                organization: job.company,
                location: job.location,
                type: job.type,
                salary: job.salary,
                validThrough: job.boostExpiresAt,
            });
        seenTitles.add(job.title); // Mark title as seen
    }
});
    // Display sponsored jobs if any
    const featuredJobContainer = document.getElementById('featuredJobListings');
    featuredJobContainer.innerHTML = ''; // Clear existing featured jobs

// Check if we have any results
if (!jobListingsSnapshot.empty) {
    // Update the last visible document for pagination
    lastVisible = jobListingsSnapshot.docs[jobListingsSnapshot.docs.length - 1];

    // Handle unique job listings and render them
    jobListings.forEach(job => createJobCard(job, featuredJobContainer));
    console.log("Filtered Job Listings:", jobListings);
} else {
    console.log("No jobs found or no more jobs to load.");
}

        const sponsoredJobs = [];

        // Process sponsored jobs
        sponsorsSnapshot.forEach(doc => {
            const data = doc.data();
            sponsoredJobs.push({
                id: data.id,
                title: data.title,
                description: data.description,
                datePosted: data.createdAt,
                organization: data.company,
                location: data.location,
                employmentType: data.type,
                baseSalary: data.salary,
                validThrough: data.boostExpiresAt,
                url: data.id
            });
        });

        return { jobListings, sponsoredJobs }; // Return both job listings and sponsored jobs

    } catch (error) {
        console.error("Error fetching job listings: ", error);
        return { jobListings: [], sponsoredJobs: [] }; // Return empty arrays in case of an error
    }
}

// Function to display job listings and sponsors
function displayJobListings({ jobListings, sponsoredJobs }) {
    const jobContainer = document.getElementById('jobListings');
    jobContainer.innerHTML = ''; // Clear existing listings

    jobListings.forEach(job => {
        const jobCard = createJobCard(job);
        jobContainer.innerHTML += jobCard; // Append job card to container
    });


    sponsoredJobs.forEach(sponsoredJob => {
        const featuredJobCard = createSponsoredJobCard(sponsoredJob);
        featuredJobContainer.innerHTML += featuredJobCard; // Append sponsored job card to featured jobs
    });
}

// Helper function to create a job card
function createJobCard(job) {
    return `
        <div class="col-md-4 mb-4 d-flex">
            <div class="card h-100"> <!-- Add h-100 to make sure card takes full height -->
                <div class="card-body">
                    <h5 class="card-title">${job.title}</h5>
                    <h6 class="card-subtitle mb-2 text-muted">${job.organization}</h6>
                    <p class="card-text">
                        ${formatLocation(job.location, { part: 'city' })}, ${formatLocation(job.location, { part: 'state' })}
                    </p>
                    <p class="card-text"><strong>Type:</strong> ${formatJobType(job.type)}</p>
                    <p class="card-text"><strong>Salary:</strong> ${formatCurrency(job.salary, {decimals: 0})}</p>

                    <button class="btn btn-info" onclick="showJobDetailsFunc('${job.id}')">View Details</button>
                </div>
            </div>
        </div>
    `;
}


// Helper function to create a sponsored job card
function createSponsoredJobCard(sponsoredJob) {
    return `
        <div class="col-md-4 mb-4">
            <div class="card border-success">
                <div class="card-body">
                    <h5 class="card-title">${sponsoredJob.title}</h5>
                    <h6 class="card-subtitle mb-2 text-muted">${sponsoredJob.organization}</h6>
                     <p class="card-text"><strong>Type:</strong> ${formatJobType(sponsoredJob.type)}</p>
                     <p class="card-text"><strong>Salary:</strong> ${formatCurrency(sponsoredJob.salary)}</p>
                    <div  onclick="showJobDetailsFunc('${sponsoredJob.id}')" class="btn btn-success">Apply Now</div>
                </div>
            </div>
        </div>
    `;
}



// Function to collect job requirements
function collectJobRequirements() {
    return document.getElementById("jobRequirements").value.split(',').map(req => req.trim());
}

function searchJobs() {
    const requirements = collectJobRequirements();
    const location = document.getElementById("jobLocation").value;
    const city = document.getElementById("jobCity").value;
    const state = document.getElementById("jobState").value;
    const zipCode = document.getElementById("jobZip").value;
    const salaryMin = document.getElementById("salaryMin").value;
    const salaryMax = document.getElementById("salaryMax").value;
    const contractType = document.getElementById("contractType").value;
    const industry = document.getElementById("industry").value;
    const immediateHire = document.getElementById("immediateHire").checked;
    const contractToHire = document.getElementById("contractToHire").checked;

    // You can now use these values to filter job listings
    console.log({
        requirements,
        location,
        city,
        state,
        zipCode,
        salaryMin,
        salaryMax,
        contractType,
        industry,
        immediateHire,
        contractToHire
    });

    async function fetchFilteredJobListings({
    requirements,
    location,
    city,
    state,
    zipCode,
    salaryMin,
    salaryMax,
    contractType,
    industry,
    immediateHire,
    contractToHire,
}) {
    try {
        const jobListingsRef = firestore.collection('Jobs'); // Replace with your collection name
        let query = jobListingsRef;

        // Check if each field has a value and build the query accordingly
        if (requirements) {
            query = query.where('requirements', 'array-contains', requirements);
        }
        if (location) {
            query = query.where('location', '==', location);
        }
        if (city) {
            query = query.where('city', '==', city);
        }
        if (state) {
            query = query.where('state', '==', state);
        }
        if (zipCode) {
            query = query.where('zipCode', '==', zipCode);
        }
        if (salaryMin) {
            query = query.where('salary', '>=', salaryMin);
        }
        if (salaryMax) {
            query = query.where('salary', '<=', salaryMax);
        }
        if (contractType) {
            query = query.where('type', '==', contractType);
        }
        if (industry) {
            query = query.where('industry', '==', industry);
        }
        if (immediateHire !== undefined) { // Check for truthy/falsy
            query = query.where('immediateHire', '==', immediateHire);
        }
        if (contractToHire !== undefined) { // Check for truthy/falsy
            query = query.where('contractToHire', '==', contractToHire);
        }

        // Execute the query
        const jobListingsSnapshot = await query.get();
        const jobListings = jobListingsSnapshot.docs.map(data => ({
                id: data.id,
                title: data.title,
                description: data.description,
                datePosted: data.createdAt,
                organization: data.company,
                location: data.location,
                employmentType: data.type,
                baseSalary: data.salary,
                validThrough: data.boostExpiresAt,
                url: data.id
        
                }));
                function generateSchemaMarkup(jobListings) {
    // Check if jobListings is an array
    if (!Array.isArray(jobListings)) {
        console.error("jobListings should be an array. Received:", jobListings);
        return; // Exit the function if it's not an array
    }

    // Map through jobListings to generate schema data
    const schemaData = {
        "@context": "https://schema.org",
        "@type": "JobPosting",
        "title": jobListings.map(job => job.title).join(', '), // Join to create a single string
        "description": jobListings.map(job => job.description).join(' '), // Join descriptions into one string
        "datePosted": jobListings.map(job => job.datePosted).join(', '), // Join dates
        "hiringOrganization": {
            "@type": "Organization",
            "name": jobListings.map(job => job.organization).join(', ') // Join organizations
        },
        "jobLocation": {
            "@type": "Place",
            "address": {
                "@type": "PostalAddress",
                "addressLocality": jobListings.map(job => job.location).join(', ') // Join locations
            }
        },
        "employmentType": jobListings.map(job => job.employmentType).join(', '), // Join employment types
        "baseSalary": {
            "@type": "MonetaryAmount",
            "value": jobListings.map(job => job.baseSalary).join(', '), // Join salary values
            "currency": "USD"
        },
        "validThrough": jobListings.map(job => job.validThrough).join(', ') // Join validity dates
    };

    const scriptTag = document.createElement('script');
    scriptTag.type = 'application/ld+json';
    scriptTag.innerHTML = JSON.stringify(schemaData);
    document.head.appendChild(scriptTag); // Append schema markup to head
}



        displayJobListings(jobListings);

// Example of how to call this function when window loads
window.onload = function() {
    generateSchemaMarkup(jobListings);
};


    } catch (error) {
        console.error("Error fetching filtered job listings: ", error);
        throw error; // Rethrow the error to handle it later
    }
}







    // Implement your job search logic here, e.g., fetching from an API
}



 // Function to get URL parameters
 function getUrlParameters() {
        const params = new URLSearchParams(window.location.search);
        return {
            keywords: params.get('keywords') || '',
            location: params.get('location') || '',
            jobType: params.get('jobType') || '',
            salaryRange: params.get('salaryRange') || ''
        };
    }
    // Populate the search bar with URL parameters
    function populateSearchBar() {
      const   { keywords, location, jobType, salaryRange } = getUrlParameters();

        if (keywords) {
            document.getElementById('keywordInput').value = keywords;
        }
        if (location) {
            document.getElementById('locationInput').value = location;
        }
        if (salaryRange) {
            document.getElementById('salaryInput').value = salaryRange;
        }
        if (jobType) {
            document.getElementById('jobTypeInput').value = jobType;
        }

    // Check if at least one parameter is filled
    return keywords || location || jobType || salaryRange;

    }
        
        window.onload = async function() {
            populateSearchBar();
 // Determine if search parameters exist
 if (populateSearchBar()) {
        await searchJobs(); // Assuming this function fetches and displays results based on search criteria
    } else {
        const jobListings = await fetchJobListings(); // Fetch the job listings
        displayJobListings(jobListings); // Display job listings
    }

};


    </script>
  <!-- jQuery (Must be included before Bootstrap JS) -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    
  <!-- Popper.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.9.2/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
  
  <!-- Bootstrap JS -->
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>

</body>

</html>
