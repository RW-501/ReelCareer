<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Explore a wide range of job opportunities and apply directly through ReelCareer. Search for full-time, part-time, remote, and contract jobs tailored to your career needs.">
  <meta name="keywords" content="job search, career opportunities, full-time jobs, part-time jobs, remote jobs, contract jobs, apply for jobs, career growth, hiring">
  <meta name="robots" content="index, follow">
  <title>ReelCareer - Job Listings</title>

  <!-- Open Graph Tags -->
  <meta property="og:title" content="ReelCareer - Job Listings">
  <meta property="og:description" content="Find your next job opportunity with ReelCareer. Browse a variety of job listings tailored to your skills and preferences.">
  <meta property="og:image" content="https://www.reelcareer.co/images/logo.png">
  <meta property="og:url" content="https://www.reelcareer.co/job-listings.html">
  <meta property="og:type" content="website">

  <!-- Twitter Card Tags -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="ReelCareer - Job Listings">
  <meta name="twitter:description" content="Explore a range of job opportunities and apply directly through ReelCareer. Your next career move is just a search away.">
  <meta name="twitter:image" content="https://www.reelcareer.co/images/logo.png">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

  <!-- Other CSS files -->
  <link rel="stylesheet" href="../public/css/styles.css"> <!-- Custom CSS for your page -->

  <!-- Favicon links -->
  <link rel="icon" type="image/x-icon" href="/images/favicons/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicons/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/images/favicons/android-chrome-192x192.png">
  <link rel="icon" type="image/png" sizes="512x512" href="/images/favicons/android-chrome-512x512.png">

  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-LBTK319K2X"></script>
  <script src="../public/js/loadScripts.js"></script>
</head>
<style>
  body {
    font-family: 'Arial', sans-serif;
    background-color: #f1f3f5;
    /* Light grey background */
  }

  h1 {
    color: #5b6369;
    font-size: 1.5rem !important;
  }

  .job-detail-container {
    background-color: #ffffff;
    border-radius: 15px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    padding: 40px;
    margin-top: 30px;
  }

  .job-logo {
    max-width: 150px;
    border-radius: 10px;
    margin-right: 20px;
  }

  .apply-btn {
    background-color: #007bff;
    color: white;
    border-radius: 5px;
    padding: 12px 25px;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }

  .apply-btn:hover {
    background-color: #0056b3;
    transform: translateY(-2px);
  }

  .job-info,
  .job-tags,
  .job-requirements {
    margin-bottom: 20px;
  }

  .job-info p {
    font-size: 16px;
    margin-bottom: 10px;
  }

  hr {
    border-top: 1px solid #e9ecef;
    margin: 20px 0;
  }

  .job-tags {
    background-color: #e9ecef;
    border-radius: 5px;
    padding: 5px 10px;
    display: inline-block;
    margin-right: 10px;
    margin-bottom: 10px;
  }

  @media (max-width: 576px) {
    .job-detail-container {
      padding: 20px;
    }

    #applyBtn {
      width: 100%;
    }
  }

  #applyBtn:hover {
    background-color: #0062cc;
    transform: scale(1.05);
  }

  /* Error message styling */
  #error-message {
    margin: 20px auto;
    padding: 20px;
    border: 1px solid red;
    background-color: #ffe5e5;
    border-radius: 5px;
    max-width: 600px;
    text-align: center;
  }

  #error-message h2 {
    color: red;
    margin-bottom: 10px;
  }

  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }

  .close:hover,
  .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }

  .modal-actions {
    margin-top: 20px;
  }

  .modal-actions .btn {
    padding: 10px 20px;
    margin: 10px;
    cursor: pointer;
  }

  .btn-primary {
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
  }

  .btn-success {
    background-color: #28a745;
    color: white;
    border: none;
    border-radius: 5px;
  }

  .btn-secondary {
    background-color: #6c757d;
    color: white;
    border: none;
    border-radius: 5px;
  }

  #reportJobModal .modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.5);
    /* Black with opacity */
  }

  #reportJobModal .modal-content {
    background-color: #fff;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    max-width: 600px;
  }

  #reportJobModal .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
  }

  #reportJobModal .close:hover,
  #reportJobModal .close:focus {
    color: black;
    text-decoration: none;
    cursor: pointer;
  }

  /* Style for similar jobs container */
  .similar-jobs {
    margin-top: 30px;
  }

  .similar-job-card {
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    background-color: #fff;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease-in-out;
  }

  .similar-job-card:hover {
    transform: translateY(-5px);
  }

  .similar-job-card h5 {
    font-size: 1.25rem;
    color: #80b6d5;
    font-weight: 600;
  }

  .similar-job-card .job-tags {
    margin-top: 10px;
  }

  .similar-job-card .badge {
    background-color: #80b6d5;
    color: #e9ecef;
    margin-right: 5px;
    padding: 5px 10px;
    border-radius: 1rem;
    font-size: 0.8rem;
    font-weight: 700;
  }

  .similar-job-card .view-job-btn {
    margin-top: 10px;
    text-align: right;
    display: block;
    text-decoration: none;
    color: #fff;
    background-color: #80b6d5 !important;
    padding: 10px 15px;
    border-radius: 5px;
    font-weight: bold;
    transition: background-color 0.2s ease;
  }

  .similar-job-card .view-job-btn:hover {
    background-color: #aaabac;
  }

  .empty-state {
    padding: 20px;
    border: 2px dashed #ddd;
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    transition: transform 0.2s ease-in-out;
  }

  .empty-state i {
    color: #ccc;
  }

  .empty-state p {
    font-size: 1.1em;
    color: #666;
  }

  .job-info-box {
    background-color: #f8f9fa;
    /* Light gray background */
    border-radius: 5px;
    /* Rounded corners */
    padding: 15px;
    /* Padding around the content */
    margin: 15px 0;
    /* Space around the box */
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    /* Subtle shadow */
    transition: background-color 0.3s, box-shadow 0.3s;
    /* Smooth transition for hover effects */
  }

  .job-info-box:hover {
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    /* Increase shadow on hover */
    background-color: #e9ecef;
    /* Slightly darker background */
  }

  .job-info {
    line-height: 1.2;
    /* Reduce line spacing */
  }

  .job-info p {
    margin: 5px 0;
    /* Reduced margin between paragraphs for consistency */
  }

  .job-info strong {
    color: #6c757d;
    /* Muted titles */
    font-weight: 600;
    /* Adjust weight for titles */
  }

  .job-info span {
    font-weight: 400;
    /* Adjust weight for content */
  }

  .btn-primary {
    background-color: #639ad4 !important;
    color: white;
    border: none;
    border-radius: 5px;
  }

  h3 {
    font-size: 2.75rem !important;
    color: #83bad9 !important;
    text-shadow: -1px 1px 0px #9e9a9a;
    font-weight: 800 !important;
  }/* General Styling */
body {
  font-family: 'Roboto', sans-serif;
}

/* Job Info Boxes */
.job-info-box {
  background-color: #f8f9fa;
  border-radius: 10px;
  padding: 1.5rem;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.text-muted {
  font-size: 1rem;
  line-height: 1.6;
}

.job-tags span {
  background-color: #e0e7ff;
  padding: 5px 10px;
  border-radius: 5px;
  margin-right: 5px;
  font-size: 0.875rem;
}

.job-tags button {
    background-color: #83bad9;

}

.job-tags button:hover {

background-color: #0056b3;
}

/* Buttons */
.btn {
  border-radius: 25px;
}

 /* 
.btn:hover {

 background-color: #0056b3;
}
*/
.btn-outline-secondary:hover {
  background-color: #e9ecef;
}

/* Box Shadows */
.shadow-sm {
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.text-indent {
  text-indent: 1.5rem;
}

img.job-logo {
  width: 150px;
  height: 150px;
}

p {
  margin-bottom: 1rem;
}

h1, h2, h4, h5 {
  margin-bottom: 1rem;
}
.text-left{
text-align: left;
}


</style>

<!-- Bootstrap CSS -->
<script src="../public/js/scripts.js"></script>
<script src="../public/js/loadScripts.js"></script>
<!-- Custom CSS -->
<link rel="stylesheet" href="../public/css/styles.css">

<body>
  <script src="../public/js/bodyload.js"></script>

  <!-- Navigation Bar -->
  <nav class="navbar navbar-expand-lg navbar-dark" role="navigation" aria-label="Main navigation">
    <a class="navbar-brand" href="../index.html">ReelCareer</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item active">
          <a class="nav-link" href="../index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="job-listings.html">Job Listings</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="about.html">About Us</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="contact.html">Contact</a>
        </li>
      </ul>
    </div>
  </nav>
<main>
<!-- Job Detail Section -->
<div id="job-container" class="container py-5">

  
    <div class="job-detail-container bg-white shadow-sm p-4 rounded my-4" role="main" aria-labelledby="jobTitle">
      <div class="row">



        <!--  Left Area -->
        <div class="col-md-4 text-center">

                        <!-- Company Logo and Mission -->
    <div class="text-center">
        <img id="companyLogo" class="job-logo img-fluid rounded-circle shadow" alt="Company Logo" src="/images/sq_logo_n_BG.png" loading="lazy" />
        <h4 class="fw-bold mt-4">Our Mission</h4>
        <p id="companyMission" class="text-muted font-italic px-5">Company Mission Statement goes here...</p>
      </div>
              <!--  Actions -->

          <button id="saveBtn" class="btn btn-outline-secondary w-100 mb-3" onclick="saveJob()">Save for Later</button>
          <button id="reportJobBtn" class="btn btn-warning w-100" onclick="openReportJobModal()">Report Job</button>
       
          <div class="text-left mt-3">
            <p  class=" mt-1 mb-0"><label>Submitted By:</label> <name id="submittedBy" class="text-muted font-italic "></name></p>
            <p  class=" mt-1 mb-0"><label>Job:</label> <id id="jobID" class="text-muted font-italic "></id></p>
            <p  class=" mt-1 "><label>Applicant Count:</label> <id id="applicantCount" class="text-muted font-italic "></id></p>
          </div>
       
        </div>
        <!-- Job Title & Info -->
        <div class="col-md-8">
          <h1 id="jobTitle" class="text-primary fw-bold mb-3"></h1>
          <div class="job-info-box bg-light rounded-3 shadow-sm p-4">
            <p><strong>Company:</strong> <company id="companyName"></company></p>
            <p><address id="jobLocation"></address></p>
            <p><strong>Industry:</strong> <industry id="industry"></industry></p>
            <p><strong>Employment Type:</strong> <employmentType id="employmentType"></employmentType></p>
            <p><strong>Salary:</strong> <salary id="salary"></salary> <span id="salaryPayTime"></span></p>
            <p><strong>Posted On:</strong> <date id="createdAt" class="font-italic"></date></p>
          </div>
        </div>
      </div>
  
      <!-- Company Website and Description -->
      <hr class="my-4" />
      <div class="mb-4">
        <a id="companyWebsite" class="text-info" href="" target="_blank">Company Website</a>
        <p id="companyDescription" class="text-muted mt-3"></p>
        <a id="companyPageLink" class="text-info" href="">View Company Page</a>
      </div>
  
      <!-- Job Description -->
      <div class="job-info-box bg-light rounded-3 shadow-sm p-4 mb-4">
        <h4>Job Description</h4>
        <p id="jobDescription" class="text-muted"></p>
        <p><strong>Job Function:</strong> <span id="jobFunction"></span></p>
      </div>
  
      <!-- Job Requirements -->
      <div class="job-info-box bg-light rounded-3 shadow-sm p-4 mb-4">
        <h5>Job Requirements</h5>
        <p id="jobRequirements" class="text-muted "></p>

        <p><strong>Education Required:</strong></p>
        <ul id="educationRequirements" class="list-unstyled"></ul>
        <p><strong>Experience Required:</strong></p>
        <ul id="experienceRequirements" class="list-unstyled"></ul>
      </div>
  
      <!-- Additional Job Details -->
      <div id="jobBenefitsArea" class="job-info-box bg-light rounded-3 shadow-sm p-4 mb-4">
        <h5>Job Benefits</h5>
        <ul id="jobBenefits" class="list-unstyled"></ul>
      </div>
  
      <!-- Job Tags -->
      <div class="mb-4">
        <h5><strong>Tags:</strong></h5>
        <span id="jobTags" class="job-tags"></span>
      </div>
  




      <hr />

      <!-- Social Media Sharing Buttons -->
      <div class="social-sharing m-auto job-info-box shadow-sm rounded p-3">
        <h5><strong>Share this job:</strong></h5>
        <div class="d-flex justify-content-between">
          <a id="facebookShare" target="_blank" class="btn btn-facebook btn-sm" style="color: #3b5998;">
            <i class="fab fa-facebook-f"></i> Share on Facebook
          </a>
          <a id="twitterShare" target="_blank" class="btn btn-twitter btn-sm" style="color: #1da1f2;">
            <i class="fab fa-twitter"></i> Tweet This Job
          </a>
          <a id="linkedinShare" target="_blank" class="btn btn-linkedin btn-sm" style="color: #0077b5;">
            <i class="fab fa-linkedin-in"></i> Share on LinkedIn
          </a>
          <a id="emailShare" class="btn btn-email btn-sm" style="color: #d44638;">
            <i class="fas fa-envelope"></i> Share via Email
          </a>
        </div>
      </div>

      <hr />






      <!-- Apply Button -->
      <button id="applyBtn" class="btn btn-primary btn-lg w-100 mt-4" aria-label="Apply for this job">Apply Now</button>
    </div>
  </div>
  
    <hr />
    <div class="ml-3 mr-3">

    <!-- Similar Jobs Section -->
    <div class="similar-jobs mt-5">
      <h3>Similar Jobs</h3>
      <hr />
      <div id="similarJobsContainer" class="row">
        <!-- Dynamically insert similar jobs here -->
      </div>
    </div>

    <hr />

    <div class="related-blogs mt-5  ">
      <h3>Related Articles</h3>
      <hr />
      <div id="blogContainer" class="row">
        <!-- Blog links will be dynamically inserted here -->
      </div>
    </div>
    </div>

  </div>

</main>



  <div id="error-message" style="display: none; color: red; text-align: center;">
    <!-- Error message will be dynamically inserted here -->
  </div>

  <!-- Modal Structure -->
  <div id="applicationModal" class="modal " role="dialog" aria-labelledby="applicationModal" >
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>External Application</h2>
      <p>This application will take you to an external website. Do you want to proceed?</p>
      <div class="modal-actions">
        <button id="proceedBtn" class="btn btn-primary">Proceed to Application</button>
        <button id="cancelBtn" class="btn btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <div id="reportJobModal" class="modal " role="dialog" aria-labelledby="reportJobTitle" >
    <div class="modal-content">
      <span class="close" aria-label="Close" onclick="closeReportJobModal()">&times;</span>
      <form id="reportJobForm">
        <h2 id="reportJobTitle">Report Job</h2>
        <p>Please select the reason(s) for reporting this job:</p>

        <div class="checkbox-group">
          <input type="checkbox" id="spam" name="reason" value="Spam">
          <label for="spam">Spam</label><br>

          <input type="checkbox" id="incorrectInfo" name="reason" value="Incorrect Information">
          <label for="incorrectInfo">Incorrect Information</label><br>

          <input type="checkbox" id="scam" name="reason" value="Scam">
          <label for="scam">Potential Scam</label><br>

          <input type="checkbox" id="other" name="reason" value="Other">
          <label for="other">Other</label><br>
        </div>

        <textarea id="reportMessage" class="form-control mt-3" rows="4" placeholder="Additional details..."></textarea>

        <button type="button" class="btn btn-primary mt-3" onclick="submitReport()">Submit Report</button>
      </form>
    </div>
  </div>

  <!-- Footer -->
  <footer id="dynamic-footer"></footer>

  <!-- Firebase configuration/ Login & Out -->
  <script type="module" src="../public/js/main.js"></script>

  <script type="module">
    let jobID = "";

    import {
      db,
      auth,
      analytics,
      app
    } from '../public/js/main.js'; // Adjust path to your Firebase setup
    import {
      doc,
      getDoc,
      setDoc,
      updateDoc,
      arrayUnion,
      increment,
      collection,
      query,
      where,
      getDocs,
      limit
    } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";
    // Function to save job and update savedForLater count
    async function saveJob() { 
  // Disable the button and change text
  const saveBtn = document.getElementById('saveBtn');
  saveBtn.disabled = true;
  saveBtn.textContent = "Saving...";

  // Log the jobId for debugging
  console.log("Job ID: ", jobID);

  if (!jobID) {
    console.error("Job ID is undefined or invalid.");
    saveBtn.textContent = "Save Job";
    saveBtn.disabled = false;
    return;
  }

  try {
    const user = auth.currentUser; // Ensure auth is properly initialized
    if (!user) {
      alert("You need to be logged in to save jobs.");
      saveBtn.disabled = false;
      saveBtn.textContent = "Save Job";
      return;
    }

    // Get user-specific saved jobs from the 'Users' collection
    const userSavedJobsRef = doc(db, 'Users', user.uid);
    const userSavedJobsDoc = await getDoc(userSavedJobsRef);

    // Check if the job is already saved
    if (userSavedJobsDoc.exists() && userSavedJobsDoc.data().savedJobs?.includes(jobID)) {
      saveBtn.textContent = "Saved!";
      saveBtn.classList.add('btn-success');
      return;
    }

    // Save the job to the user's savedJobs array using arrayUnion to prevent duplicates
    await updateDoc(userSavedJobsRef, {
      savedJobs: arrayUnion(jobID)
    });

    // Successfully saved
    saveBtn.textContent = "Saved!";
    saveBtn.classList.add('btn-success');

  } catch (error) {
    console.error("Error saving job: ", error);
    alert("Error saving the job. Please try again.");
  } finally {
    saveBtn.disabled = false;
    saveBtn.textContent = "Save Job";
  }
}

    let companyData = "";
    // Function to fetch job details
    async function fetchJobDetails() {
      const urlParams = new URLSearchParams(window.location.search);
      const jobId = urlParams.get('id'); // Get job ID from URL
      const errorMessageDiv = document.getElementById('error-message');
      const jobContainer = document.getElementById('job-container');
      if (!jobId || jobId === "undefined") {
        // Insert "Job not found" HTML into the error-message div
        errorMessageDiv.innerHTML = `
            <h2>Job Not Found</h2>
            <p>We couldn't find the job you're looking for. It might have been removed or is no longer available.</p>
            <a href="ReelCareer/views/job-listing-page" class="btn btn-primary">Back to Jobs</a>
        `;
      }
      try {
  const jobDocRef = doc(db, 'Jobs', jobId);
  const jobDoc = await getDoc(jobDocRef);
  let jobData = '';

  if (jobDoc.exists()) {
     jobData = jobDoc.data();
    jobData.id = jobDoc.id; // Attach the document ID to the data
    loadJobDetails(jobData); // Call loadJobDetails with jobData, now containing the ID
  } else {
          // Insert "Job not found" HTML into the error-message div
          errorMessageDiv.innerHTML = `
            <h2>Job Not Found</h2>
            <p>We couldn't find the job you're looking for. It might have been removed or is no longer available.</p>
            <a href="ReelCareer/views/job-listing-page" class="btn btn-primary">Back to Jobs</a>
        `;
          errorMessageDiv.style.display = 'block';
          jobContainer.style.display = 'none'; // Hide job details section if applicable
        }
      } catch (error) {
        console.error("Error fetching job details: ", error);
        // Display an error message on the page
        errorMessageDiv.innerHTML = `
            <h2>Error Fetching Job Details</h2>
            <p>There was an error retrieving the job details. Please try again later.</p>
            <a href="/job-listing-page" class="btn btn-primary">Back to Jobs</a>
        `;
        errorMessageDiv.style.display = 'block';
        jobContainer.style.display = 'none'; // Hide job details
      }
    }
    // Function to load job details into the HTML
    async function loadJobDetails(jobData) {
        console.log('Job ID:', jobData.id);
jobID = jobData.id;

      const createdAt = jobData.createdAt?.toDate ? jobData.createdAt.toDate() : "N/A"; // Fallback to "N/A" if not available
      document.getElementById('jobTitle').textContent = jobData.title;
      document.getElementById('jobID').textContent = jobData.id;
      document.getElementById("jobDescription").innerText = jobData.description;
      document.getElementById('jobLocation').textContent = formatLocation(jobData.location);

    document.getElementById('employmentType').textContent = formatJobType(jobData.type);
      document.getElementById('salary').textContent = formatCurrency(jobData.salary, {
        decimals: 0
      });
      document.getElementById('submittedBy').textContent = jobData.submittedBy;
      document.getElementById('industry').textContent = jobData.industry;
      document.getElementById('createdAt').textContent = createdAt instanceof Date ? createdAt.toLocaleDateString() : createdAt;
      


  // New Fields
  document.getElementById('salaryPayTime').textContent = jobData.salaryPayTime || "N/A";
 document.getElementById('jobFunction').textContent = jobData.jobFunction || "N/A";

 document.getElementById('jobRequirements').textContent = jobData.benefits;
 document.getElementById('jobBenefits').textContent = jobData.requirements;

  // Education Requirements (array)
  const educationList = document.getElementById('educationRequirements');
  if (jobData.searchableRequirements.education && jobData.searchableRequirements.education.length > 0) {
    jobData.searchableRequirements.education.forEach(edu => {
      const listItem = document.createElement('li');
      listItem.textContent = edu;
      educationList.appendChild(listItem);
    });
  } else {
    educationList.textContent = "Not specified";
  }

  // Experience Requirements (array)
  const experienceList = document.getElementById('experienceRequirements');
  if (jobData.searchableRequirements.experience && jobData.searchableRequirements.experience.length > 0) {
    jobData.searchableRequirements.experience.forEach(exp => {
      const listItem = document.createElement('li');
      listItem.textContent = exp+" Years Experience";
      experienceList.appendChild(listItem);
    });
  } else {
    experienceList.textContent = "Not specified";
  }


      
      
      // Populate company-related details
      document.getElementById("companyName").innerText = jobData.company;
      if (jobData.companyId) {
        // Create a link to the company page
        const companyPageLink = document.getElementById("companyPageLink");
        companyPageLink.href = `/views/company-page?c=${jobData.companyId}`;
        companyPageLink.textContent = "View Company Page";
      } else {
        document.getElementById("companyPageLink").style.display = "none";
      }
  
      // Fetch company details using companyId from the Companies collection
      try {
        if (jobData.companyId) {
          const companyRef = doc(db, 'Companies', jobData.companyId);
          const companyDoc = await getDoc(companyRef);
          if (companyDoc.exists()) {
            companyData = companyDoc.data();
            document.getElementById("companyLogo").src = companyData.logo ? companyData.logo : "https://reelcareer.co/images/sq_logo_n_BG.png";
            document.getElementById("companyWebsite").href = companyData.website;
            document.getElementById("companyDescription").innerText = companyData.description;
            document.getElementById("companyMission").innerText = companyData.missionStatement;
          } else {
            console.log("No such company!");
          }
        }
      } catch (error) {
        console.error("Error fetching company details: ", error);
      }
      if (jobData.applicationDeadline && jobData.applicationDeadline.toDate) {

    }

      document.getElementById('applicantCount').textContent = jobData.applicantCount || 0;
      document.getElementById('companyWebsite').href = jobData.companyWebsite;
      


      let jobTags = jobData.tags; // Get tags from the current job
      if (!jobTags || jobTags.length === 0) {
          console.log("No tags available for this job.");
          jobTags = ['Jobs', jobData.industry, 'Job Search'];
        }

      renderTags(jobTags);

          // Fetch and display similar jobs
          getSimilarJobs(jobTags);
      loadRelatedBlogs(jobTags);
      // Assuming you have your job data in jobData
      const companyWebsite = document.getElementById('companyWebsite');
      const jobBenefitsArea = document.getElementById('jobBenefitsArea');
      const companyPageLink = document.getElementById('companyPageLink');


      // Check if all company elements are empty or missing content
      // Check if the company website is valid
      if (!jobData.companyWebsite || companyWebsite.href === "undefined" ||  jobData.companyWebsite ===  undefined || jobData.companyWebsite.trim() === "") {
        companyWebsite.style.display = "none"; // Hides the company website link if undefined or empty
      }

      // Check if job benefits are available
      if (!jobData.jobBenefits || jobData.jobBenefits.length === 0) {
        jobBenefitsArea.style.display = "none"; // Hides the entire job benefits section if empty
      }

      function displayEmptyState(container, message, iconClass = 'fas fa-search') {
        container.innerHTML = `
        <div class="empty-state text-center my-4">
            <i class="${iconClass} fa-3x text-muted"></i>
            <p class="text-muted mt-2">${message}</p>
        </div>
    `;
      }


      // Function to fetch similar jobs based on tags
      async function getSimilarJobs(jobTags) {
        const maxSimilarJobs = 5; // Limit to 5 similar jobs

        // Query the Jobs collection to find jobs with matching tags
        const jobsReff = collection(db, 'Jobs'); // Correctly use the imported Firestore instance
        const q = query(jobsReff, where('tags', 'array-contains-any', jobTags), limit(maxSimilarJobs));
        console.log("q    ", q);
        try {
          const querySnapshot = await getDocs(q);
          // Clear the similar jobs container
          const similarJobsContainer = document.getElementById('similarJobsContainer');
          similarJobsContainer.innerHTML = '';
          querySnapshot.forEach(doc => {
            const similarJob = doc.data();
            if (querySnapshot.empty) {
              displayEmptyState(similarJobsContainer, 'No related jobs found.', 'fas fa-briefcase');
              return;
            }
            // Skip the current job itself in the results
            if (doc.id === jobData.id) return;
            // Create the card element for similar jobs
            const jobCard = document.createElement('div');
            jobCard.classList.add('col-md-6', 'col-lg-4', 'mb-3');
            jobCard.innerHTML = `
    <div class="similar-job-card">
        <!-- Job Title as a Link -->
        <h5><a href="../views/job-detail?id=${doc.id}" class="job-title-link">${similarJob.title}</a></h5>
        
        <p><strong>${similarJob.company}</strong> - ${formatLocation(similarJob.location)}</p>

        <p class="card-text"><text-muted>Type:</text-muted><strong> ${formatJobType(similarJob.type)}</strong></p>
        <p class="card-text"><text-muted>Salary:</text-muted>${formatCurrency(similarJob.salary, { decimals: 0 })}</p>

        <!-- Display job tags -->
        <div class="job-tags mt-2">
            ${similarJob.tags.map(tag => `
                <a href="../views/job-listings/?tag=${encodeURIComponent(tag)}" class="btn btn-primary badge" style="margin: 0.2rem;">
                    ${tag}
                </a>
            `).join('')}
        </div>

        <!-- View Job Button -->
        <a href="../views/job-detail?id=${doc.id}" class="view-job-btn">View Job</a>
    </div>
`;
            // Append the card to the container <img src="${similarJob.logo}" alt="${similarJob.company} Logo" class="img-fluid job-logo" loading="lazy" />
            similarJobsContainer.appendChild(jobCard);
          });
        } catch (error) {
          console.error("Error fetching similar jobs: ", error);
          displayEmptyState(similarJobsContainer, 'Error loading similar jobs.', 'fas fa-briefcase');
        };
      }
      async function loadRelatedBlogs(jobTags) {
        try {
            console.log("jobTags  ", jobTags);

          // Reference the 'Blogs' collection and query for blogs with matching industry tags
          const blogsRef = collection(db, 'Blogs');
          const q = query(blogsRef, where('tags', 'array-contains-any', jobTags), limit(3));
          console.log("q tags  ", q);

          // Get the query snapshot
          const querySnapshot = await getDocs(q);
          const blogContainer = document.getElementById('blogContainer');
          blogContainer.innerHTML = ''; // Clear previous blog content
          if (querySnapshot.empty) {
            displayEmptyState(blogContainer, 'No related blogs found.', 'fas fa-newspaper');
            return;
          }
          querySnapshot.forEach(doc => {
            const blog = doc.data();


            const blogCard = document.createElement('div');
            blogCard.classList.add('blog-card');
            blogCard.innerHTML = ` 
    <!-- Blog Card Container -->
    <div class="card blog-card h-100 shadow-sm">
        <!-- Blog Image with clickable link -->
        <a href="/views/blog?b=${doc.id}" class="blog-image-link">
            <img src="${blog.imageUrl}" alt="${blog.title}" class="img-fluid blog-image rounded-top" loading="lazy" />
        </a>

        <!-- Blog Content -->
        <div class="card-body">
            <!-- Blog Title -->
            <h5 class="card-title text-primary">${blog.title}</h5>
            
            <!-- Truncated Blog Content -->
            <p class="card-text text-muted">${truncateText(blog.content, 80)}</p>

            <!-- Read More Button -->
            <a href="/views/blog?b=${doc.id}" class="btn btn-outline-primary" aria-label="Read more about ${blog.title}">Read More</a>
        </div>
    </div>
`;
            blogContainer.appendChild(blogCard);
          });
        } catch (error) {
          console.error("Error fetching related blogs: ", error);
        }
      }

      const jobPageURL = window.location.href; // Use current page URL
      const companyName = jobData.company; // Assuming jobData has company information
      const jobTitle = jobData.title; // Job title
      const jobDescription = jobData.description; // Short job description
      // Dynamically update social sharing links
      document.getElementById('facebookShare').href = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(jobPageURL)}`;
      document.getElementById('twitterShare').href = `https://twitter.com/intent/tweet?url=${encodeURIComponent(jobPageURL)}&text=Check%20out%20this%20job%20opportunity%20at%20${encodeURIComponent(companyName)}!`;
      document.getElementById('linkedinShare').href = `https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(jobPageURL)}&title=${encodeURIComponent(jobTitle)}&summary=${encodeURIComponent(jobDescription)}&source=ReelCareer`;
      document.getElementById('emailShare').href = `mailto:?subject=Check%20out%20this%20job%20opportunity&body=I%20found%20this%20job%20at%20ReelCareer:%20${encodeURIComponent(jobPageURL)}`;


      function renderTags(tags) {
        const jobTags = document.getElementById('jobTags');
        jobTags.innerHTML = ''; // Clear previous tags
        // Check if tags is defined and is an array
        if (!tags || tags.length === 0) {
            tags = jobTags;
        }
        if (Array.isArray(tags) && tags.length > 0) {
          tags.forEach(tag => {
            // Create a button element for each tag
            const button = document.createElement('button');
            button.className = 'btn btn-secondary m-1'; // Bootstrap button styling
            button.textContent = tag;
            // Add a click event to redirect to job-listings with the selected tag
            button.onclick = () => {
              window.location.href = `../views/job-listings/?tag=${encodeURIComponent(tag)}`;
            };
            // Append the button to the jobTags container
            jobTags.appendChild(button);
          });
        } else {
          // Optionally, display a message if no tags are available
          const noTagsMessage = document.createElement('span');
          noTagsMessage.textContent = 'No tags available.';
          noTagsMessage.className = 'text-muted'; // Optional styling
          jobTags.appendChild(noTagsMessage);
        }
      }




// Apply button event listener
document.getElementById('applyBtn').addEventListener('click', function() {
    if (jobData.applicationAvailableBool) {
        // Redirect to the application page on your site
        document.location.href = `apply.html?jobId=${jobID}`;
    } else {
        // Show the modal for external application
        const modal = document.getElementById('applicationModal');

        if (modal) {
            modal.style.display = 'block'; // Ensure modal is displayed
        }
    }
});

// Proceed to external website on clicking the proceed button
const proceedBtn = document.getElementById('proceedBtn');

if (proceedBtn) {
    proceedBtn.addEventListener('click', function() {
        window.location.href = jobData.applicationWebsite;
    });
}











      // Job Schema Function
      function createJobSchema(jobData) {
        // Validate jobData if necessary
        if (!jobData) {
          //  throw new Error("jobData is required");
        } else {
          const jobSchema = {
            "@context": "https://schema.org", // Schema.org context
            "@type": "JobPosting", // Type of schema
            jobId: jobData.jobId || "", // Unique identifier for the job
            title: jobData.title || "", // Title of the job
            description: jobData.description || "", // Description of the job
            hiringOrganization: {
              "@type": "Organization",
              name: jobData.companyName || "", // Name of the company
              logo: jobData.companyLogo || "", // URL for the company logo
              website: jobData.companyWebsite || "" // Company's website link
            },
            jobLocation: {
              "@type": "Place",
              address: {
                "@type": "PostalAddress",
                addressLocality: jobData.location?.city || "", // City
                addressRegion: jobData.location?.state || "" // State
              }
            },
            employmentType: jobData.type || "", // Employment type
            baseSalary: {
              "@type": "MonetaryAmount",
              value: jobData.salary || 0, // Salary offered
              currency: "USD" // Currency type
            },
            datePosted: jobData.createdAt ? jobData.createdAt.toISOString() : new Date().toISOString(), // Date posted
            validThrough: jobData.applicationDeadline ? jobData.applicationDeadline.toISOString() : new Date(new Date().setFullYear(new Date().getFullYear() + 1)).toISOString(), // Application deadline date
            applicantCount: jobData.applicantCount || 0, // Number of applicants
            requirements: jobData.requirements || [], // List of job requirements
            benefits: jobData.benefits || [], // List of job benefits
            tags: jobData.tags || [], // Tags related to the job
            applicationAvailableBool: jobData.applicationAvailableBool || false, // Indicates if application is available
            applicationWebsite: jobData.applicationWebsite || "" // Link to the external application website
          };
          return jobSchema;
        }
      }
      // Company Schema Functionfunction createCompanySchema(companyData) {
      // Validate companyData if necessary
      if (!companyData) {
        //     throw new Error("companyData is required");
      } else {
        const companySchema = {
          "@context": "https://schema.org", // Schema.org context
          "@type": "Organization", // Type of schema
          companyId: companyData.companyId || "", // Unique identifier for the company
          name: companyData.name || "", // Name of the company
          logo: companyData.logo || "", // URL for the company logo
          website: companyData.website || "", // Company's website link
          description: companyData.description || "", // Description of the company
          missionStatement: companyData.missionStatement || "", // Company mission statement
          address: {
            "@type": "PostalAddress",
            addressLocality: companyData.location?.city || "",
            addressRegion: companyData.location?.state || "",
            postalCode: companyData.location?.postalCode || "", // Postal code
            streetAddress: companyData.location?.streetAddress || "" // Street address
          },
          contactPoint: {
            "@type": "ContactPoint",
            contactType: "Customer Service",
            telephone: companyData.phone || "", // Company phone number
            email: companyData.email || "" // Company email address
          },
          sameAs: companyData.socialLinks || [] // Social media links
        };
        return companySchema;
      }
    }
    // Load job details on page load
    document.addEventListener('DOMContentLoaded', fetchJobDetails);
    // Make the function globally accessible
    window.saveJob = saveJob;
    function submitReport() {
        // Get selected checkboxes
        const selectedReasons = [];
        document.querySelectorAll('#reportJobForm input[type="checkbox"]:checked').forEach((checkbox) => {
          selectedReasons.push(checkbox.value);
        });
        // Get the message from the textarea
        const message = document.getElementById('reportMessage').value;
        if (selectedReasons.length === 0 && !message) {
          alert("Please select a reason or enter a message before submitting.");
          return;
        }
        // Get the job details (you can fetch the job ID from the page)
        const jobTitle = document.getElementById('jobTitle').innerText;
        // Prepare the report data
        const reportData = {
          jobId: jobId,
          jobTitle: jobTitle,
          reasons: selectedReasons,
          message: message,
          submittedAt: new Date(),
          userID: userID,
        };
        // Send report to the SupportTickets collection in Firebase
        firebase.firestore().collection("SupportTickets").add(reportData)
          .then(() => {
            alert("Your report has been submitted. Thank you for your feedback.");
            closeReportJobModal(); // Close the modal after submission
          })
          .catch((error) => {
            console.error("Error submitting report: ", error);
            alert("There was an error submitting your report. Please try again later.");
          });
      }  
    // Open the modal
 // Open the report job modal
function openReportJobModal() {
    document.getElementById('reportJobModal').style.display = 'block'; // No need for !important
}

// Close the report job modal
function closeReportJobModal() {
    document.getElementById('reportJobModal').style.display = 'none'; // No need for !important
}

// Attach the modal open/close functions to the global window object
window.openReportJobModal = openReportJobModal;
window.closeReportJobModal = closeReportJobModal;


// Get elements for modal interactions
const closeModal = document.querySelector('.close');
const cancelBtn = document.getElementById('cancelBtn');
const modal = document.getElementById('applicationModal');

// Close modal on clicking the close button (X)
if (closeModal) {
    closeModal.addEventListener('click', function() {
        modal.style.display = 'none'; // No need for !important
    });
}

// Close modal on clicking the cancel button
if (cancelBtn) {
    cancelBtn.addEventListener('click', function() {
        modal.style.display = 'none'; // No need for !important
    });
}



    // Close modal if the user clicks outside of it
    window.addEventListener('click', function(event) {
      if (event.target == modal) {
        modal.style.display = 'none';
      }
    });
    </script>

  <script>

 
  </script>

  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

</body>

</html>