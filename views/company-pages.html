<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Explore the company profile, latest job openings, and get insights into the work environment.">
    <meta name="keywords" content="company profile, job openings, work environment, careers, apply now, job alerts">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Company Profile - [Company Name]">
    <meta property="og:description" content="Learn about our work environment, view available job openings, and apply directly.">
    <meta property="og:image" content="[link_to_company_image]">
    <meta property="og:url" content="[current_url]">
    <title>Company Profile - [Company Name]</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        /* Custom styles */
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa;
        }
        .company-media img, .company-media video {
            max-width: 100%;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .cta-buttons a {
            margin-right: 15px;
        }
    </style>

    <!-- Schema Markup for SEO -->
    <script type="application/ld+json">
        {
            "@context": "https://schema.org",
            "@type": "Organization",
            "name": "[Company Name]",
            "url": "[company_url]",
            "logo": "[company_logo_url]",
            "sameAs": [
                "[linkedin_url]",
                "[twitter_url]",
                "[facebook_url]"
            ],
            "address": {
                "@type": "PostalAddress",
                "streetAddress": "[Company Address]",
                "addressLocality": "[City]",
                "addressRegion": "[State]",
                "postalCode": "[ZipCode]",
                "addressCountry": "US"
            },
            "description": "[Company Description]",
            "contactPoint": {
                "@type": "ContactPoint",
                "telephone": "+1-555-555-5555",
                "contactType": "Customer Service"
            }
        }
    </script>

    <!-- Firebase Configuration -->
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.0/firebase-analytics.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDiwC3Dmd88-t3N9iRV5cZ3snVkEXinclg",
            authDomain: "reelcareer-cb4b0.firebaseapp.com",
            projectId: "reelcareer-cb4b0",
            storageBucket: "reelcareer-cb4b0.appspot.com",
            messagingSenderId: "365163764840",
            appId: "1:365163764840:web:21c44f8625c9b6831e6fdd",
            measurementId: "G-LBTK319K2X"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const analytics = firebase.analytics();
        const db = firebase.firestore();
    </script>

    <!-- Google Analytics Integration -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LBTK319K2X"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-LBTK319K2X');
    </script>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="../public/index.html">ReelCareer</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="../public/index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="../views/job-listings.html">Jobs</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Companies</a></li>
                    <li class="nav-item"><a class="nav-link" href="../views/auth.html">Login</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Company Profile Section -->
    <section class="container mt-5">
        <div class="row">
            <div class="col-md-8">
                <!-- Company Name -->
                <h2 id="companyName">Loading...</h2>
                <input type="text" id="editCompanyName" class="form-control" style="display:none;" placeholder="Enter Company Name">
    
                <!-- Company Description -->
                <p id="companyDescription" class="lead">Loading description...</p>
                <textarea id="editCompanyDescription" class="form-control" rows="3" style="display:none;" placeholder="Enter Company Description"></textarea>
    
                <!-- Company Industry -->
                <p><strong>Industry:</strong> <span id="companyIndustry">Loading...</span></p>
                <input type="text" id="editCompanyIndustry" class="form-control" style="display:none;" placeholder="Enter Industry">
    
                <!-- Company Location -->
                <p><strong>Location:</strong> <span id="companyLocation">Loading...</span></p>
                <input type="text" id="editCompanyLocation" class="form-control" style="display:none;" placeholder="Enter Location">
    
                <!-- Save and Cancel Buttons -->
                <div id="editButtons" style="display:none;">
                    <button id="saveChangesBtn" class="btn btn-primary mt-3">Save Changes</button>
                    <button id="cancelChangesBtn" class="btn btn-secondary mt-3">Cancel</button>
                </div>
            </div>
            <div class="col-md-4 text-center">
                <!-- Company Logo -->
                <img id="companyLogo" src="#" alt="Company Logo" class="img-fluid rounded-circle">
                <input type="file" id="editCompanyLogo" class="form-control mt-2" style="display:none;">
            <!-- Moderator Edit Access (Visible only to Moderators) -->
            <button id="editProfileBtn" class="btn btn-secondary" style="display:none;">Edit Profile</button>
        </div>
        </div>
    </section>
    
  
        <!-- CTA Buttons 
        <div class="cta-buttons mt-4 text-center">
            <a href="#" class="btn btn-primary">Apply Now</a>
            <a href="#" class="btn btn-success">Follow Company</a>
            <a href="#" class="btn btn-warning">Subscribe for Job Alerts</a>
        </div>
        -->

    </section>

    <!-- Company Media Section -->
    <section class="container mt-5">
        <h3>Work Environment</h3>
        <div class="company-media row">
            <div class="col-md-6">
                <video controls>
                    <source id="workEnvironmentVideo" src="#" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
            <div class="col-md-6">
                <img id="workEnvironmentImage" src="#" alt="Company Work Environment" class="img-fluid">
            </div>
        </div>
    </section>

    <!-- Job Openings Widget with Search and Filters -->
    <section class="container mt-5">
        <h3>Latest Job Openings</h3>

        <!-- Filters: Location, Job Title Search, Salary Range -->
        <div class="row mb-4">
            <div class="col-md-4">
                <select id="locationDropdown" class="form-select">
                    <option value="">All Locations</option>
                    <option value="Dallas, TX">Dallas, TX</option>
                    <option value="New York, NY">New York, NY</option>
                    <option value="Remote">Remote</option>
                </select>
            </div>
            <div class="col-md-4">
                <input type="text" id="jobTitleSearch" class="form-control" placeholder="Search by Job Title">
            </div>
            <div class="col-md-4">
                <input type="range" id="salaryRange" class="form-range" min="50000" max="200000" step="10000">
                <label for="salaryRange">Salary: <span id="salaryDisplay">$50,000+</span></label>
            </div>
        </div>

        <div id="jobOpenings" class="row">
            <!-- Job postings will be dynamically inserted here -->
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-light text-center text-lg-start mt-5">
        <div class="container p-4">
            <div class="row">
                <div class="col-lg-6 col-md-12 mb-4 mb-md-0">
                    <h5>About ReelCareer</h5>
                    <p>ReelCareer connects professionals with leading companies around the globe. Explore career opportunities that fit your passion.</p>
                </div>
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-dark">Home</a></li>
                        <li><a href="#" class="text-dark">Jobs</a></li>
                        <li><a href="#" class="text-dark">Companies</a></li>
                        <li><a href="#" class="text-dark">Contact Us</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6 mb-4 mb-md-0">
                    <h5>Follow Us</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-dark">LinkedIn</a></li>
                        <li><a href="#" class="text-dark">Twitter</a></li>
                        <li><a href="#" class="text-dark">Facebook</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="text-center p-3 bg-light">
            &copy; 2024 ReelCareer. All Rights Reserved.
        </div>
    </footer>

    <!-- Firebase Authentication and Dynamic Profile Logic -->
     <!-- Update your existing section in the company profile page with this: -->


<script>
    const auth = firebase.auth();
    const companyRef = db.collection("companies").doc(companyId);

    // Check if user is a moderator
    auth.onAuthStateChanged(user => {
        if (user) {
            db.collection("moderators").doc(user.uid).get().then(doc => {
                if (doc.exists) {
                    // Show the Edit button if the user is a moderator
                    document.getElementById("editProfileBtn").style.display = "block";
                }
            });
        }
    });

    // Toggle Edit Mode
    document.getElementById("editProfileBtn").addEventListener("click", () => {
        toggleEditMode(true);
    });

    // Save Changes button
    document.getElementById("saveChangesBtn").addEventListener("click", () => {
        saveCompanyChanges();
    });

    // Cancel Changes button
    document.getElementById("cancelChangesBtn").addEventListener("click", () => {
        toggleEditMode(false);
    });

    // Function to toggle between edit mode and view mode
    function toggleEditMode(editMode) {
        const isEditing = editMode === true;
        document.getElementById("companyName").style.display = isEditing ? "none" : "block";
        document.getElementById("companyDescription").style.display = isEditing ? "none" : "block";
        document.getElementById("companyIndustry").style.display = isEditing ? "none" : "block";
        document.getElementById("companyLocation").style.display = isEditing ? "none" : "block";
        document.getElementById("editCompanyName").style.display = isEditing ? "block" : "none";
        document.getElementById("editCompanyDescription").style.display = isEditing ? "block" : "none";
        document.getElementById("editCompanyIndustry").style.display = isEditing ? "block" : "none";
        document.getElementById("editCompanyLocation").style.display = isEditing ? "block" : "none";
        document.getElementById("editCompanyLogo").style.display = isEditing ? "block" : "none";
        document.getElementById("editButtons").style.display = isEditing ? "block" : "none";

        // Set current values to input fields if entering edit mode
        if (isEditing) {
            document.getElementById("editCompanyName").value = document.getElementById("companyName").innerText;
            document.getElementById("editCompanyDescription").value = document.getElementById("companyDescription").innerText;
            document.getElementById("editCompanyIndustry").value = document.getElementById("companyIndustry").innerText;
            document.getElementById("editCompanyLocation").value = document.getElementById("companyLocation").innerText;
        }
    }

    // Save the changes made by the moderator
    function saveCompanyChanges() {
        const updatedCompany = {
            name: document.getElementById("editCompanyName").value,
            description: document.getElementById("editCompanyDescription").value,
            industry: document.getElementById("editCompanyIndustry").value,
            location: document.getElementById("editCompanyLocation").value,
        };

        // Update Firestore
        companyRef.update(updatedCompany).then(() => {
            alert("Company profile updated successfully!");

            // Reflect changes on the page
            document.getElementById("companyName").innerText = updatedCompany.name;
            document.getElementById("companyDescription").innerText = updatedCompany.description;
            document.getElementById("companyIndustry").innerText = updatedCompany.industry;
            document.getElementById("companyLocation").innerText = updatedCompany.location;

            // Exit edit mode
            toggleEditMode(false);
        }).catch((error) => {
            console.error("Error updating company profile: ", error);
        });
    }

    // Fetch the company data and populate the page
    companyRef.get().then(doc => {
        if (doc.exists) {
            const companyData = doc.data();
            document.getElementById("companyName").innerText = companyData.name;
            document.getElementById("companyDescription").innerText = companyData.description;
            document.getElementById("companyIndustry").innerText = companyData.industry;
            document.getElementById("companyLocation").innerText = companyData.location;
            document.getElementById("companyLogo").src = companyData.logoUrl;
        } else {
            alert("No company profile found!");
        }
    }).catch((error) => {
        console.error("Error fetching company profile: ", error);
    });

    document.addEventListener("DOMContentLoaded", () => {
    // Load company details from Firestore
    const companyId = "[CompanyID]"; // replace with dynamic company ID
    db.collection("companies").doc(companyId).get().then((doc) => {
        if (doc.exists) {
            const companyData = doc.data();
            document.getElementById("companyName").textContent = companyData.name;
            document.getElementById("companyDescription").textContent = companyData.description;
            document.getElementById("companyIndustry").textContent = companyData.industry;
            document.getElementById("companyLocation").textContent = companyData.location;
            document.getElementById("companyLogo").src = companyData.logoUrl;
            document.getElementById("workEnvironmentVideo").src = companyData.videoUrl || "#";
            document.getElementById("workEnvironmentImage").src = companyData.imageUrl || "#";

            // Update dynamic meta tags
            document.title = `Company Profile - ${companyData.name}`;
            document.querySelector('meta[property="og:title"]').setAttribute("content", `Company Profile - ${companyData.name}`);
            document.querySelector('meta[name="twitter:title"]').setAttribute("content", `Company Profile - ${companyData.name}`);
            document.querySelector('meta[property="og:url"]').setAttribute("content", window.location.href);
            document.querySelector('meta[property="og:image"]').setAttribute("content", companyData.logoUrl);
            document.querySelector('meta[name="description"]').setAttribute("content", companyData.description);

            // Show edit button for moderators
            if (companyData.isModerator) {
                document.getElementById("editProfileBtn").style.display = "block";
            }
        } else {
            console.error("No such company!");
        }
    });
});
// Update Schema Markup for SEO
const schemaMarkup = {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": companyData.name,
    "url": companyData.url,
    "logo": companyData.logoUrl,
    "sameAs": [
        companyData.linkedinUrl,
        companyData.twitterUrl,
        companyData.facebookUrl
    ],
    "address": {
        "@type": "PostalAddress",
        "streetAddress": companyData.address,
        "addressLocality": companyData.city,
        "addressRegion": companyData.state,
        "postalCode": companyData.zipCode,
        "addressCountry": "US"
    },
    "description": companyData.description,
    "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+1-555-555-5555",
        "contactType": "Customer Service"
    }
};

// Inject the updated schema markup into the page
const script = document.createElement('script');
script.type = 'application/ld+json';
script.textContent = JSON.stringify(schemaMarkup);
document.head.appendChild(script);


        // Fetch company profile based on companyId in the URL
        const urlParams = new URLSearchParams(window.location.search);
        const companyId = urlParams.get('companyId');

        if (companyId) {
            db.collection("companies").doc(companyId).get().then(doc => {
                if (doc.exists) {
                    const companyData = doc.data();
                    document.getElementById("companyName").innerText = companyData.name;
                    document.getElementById("companyDescription").innerText = companyData.description;
                    document.getElementById("companyIndustry").innerText = companyData.industry;
                    document.getElementById("companyLocation").innerText = companyData.location;
                    document.getElementById("companyLogo").src = companyData.logoUrl;
                    document.getElementById("workEnvironmentVideo").src = companyData.workEnvironmentVideo;
                    document.getElementById("workEnvironmentImage").src = companyData.workEnvironmentImage;
                } else {
                    alert("Company profile not found.");
                }
            }).catch(error => {
                console.error("Error fetching company profile:", error);
            });
        } else {
            alert("No company ID provided.");
        }
    </script>
</body>
</html>
