<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Explore the company profile, latest job openings, and get insights into the work environment.">
    <meta name="keywords" content="company profile, job openings, work environment, careers, apply now, job alerts">
    <meta name="robots" content="index, follow">
    <title>ReelCareer - Company Profile - [Company Name]</title>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <style>
        /* Custom styles */
        main .company-media img, .company-media video {
            max-width: 100%;
            border-radius: 8px;
            margin-bottom: 15px;
        }
        .cta-buttons a {
            margin-right: 15px;
            transition: background-color 0.3s;
        }
        .cta-buttons a:hover {
            background-color: #0056b3; /* Change the color on hover */
            color: #fff; /* Change text color on hover */
        }
        .loading-state {
            text-align: center;
            font-size: 1.2em;
        }
        .social-icons a {
            margin: 0 5px;
            color: #007bff;
            text-decoration: none;
        }
        .social-icons a:hover {
            color: #0056b3; /* Change color on hover */
        }

        .cta-buttons a.btn-primary:hover {
    background-color: #0056b3;
    color: #fff;
}


@media (max-width: 768px) {
    .company-media img, .company-media video {
        max-width: 90%;
    }
}


h2, h4, h5 {
    color: #343a40; /* Darker color for headings */
}

.form-label {
    font-weight: bold; /* Bolder labels */
}

.img-fluid {
    max-height: 150px; /* Restrict logo height */
}




.loading-state {
    color: #6c757d; /* Light gray for loading states */
}



.btn-primary {
    background-color: #007bff; /* Primary button color */
    border-color: #007bff;
}

.btn-primary:hover {
    background-color: #0056b3; /* Darker blue on hover */
}

.btn-secondary {
    background-color: #6c757d; /* Secondary button color */
    border-color: #6c757d;
}

.btn-secondary:hover {
    background-color: #5a6268; /* Darker gray on hover */
}

/* Sidebar and Logo */
main #companyLogo {
    width: 100%;
    max-width: 150px;
    height: auto;
}

main .social-icons a {
    display: inline-block;
    margin-right: 5px;
}

main .social-icons a:hover {
    transform: scale(1.1);
    transition: transform 0.2s ease-in-out;
}

/* Responsive Styles */
@media (max-width: 768px) {
    #mainArea {
        flex-direction: column; /* Stack the columns on small screens */
    }
    .col-md-8, .col-md-4 {
        max-width: 100%; /* Full width on small screens */
    }
}


    </style>

    <script src="../public/js/scripts.js"></script>
    <script src="../public/js/loadScripts.js"></script>
    <link rel="stylesheet" href="../public/css/styles.css">
</head>


<body>
    <script src="../public/js/bodyload.js"></script>
    
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="../index.html">ReelCareer</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="../index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="job-listings.html">Jobs</a></li>
                    <li class="nav-item"><a class="nav-link" href="#">Companies</a></li>
                    <li class="nav-item"><a class="nav-link" href="auth.html">Login</a></li>
                </ul>
            </div>
        </div>
    </nav>

    
    <main >
        <div id="instructions" class="container mt-4 p-4 border rounded shadow bg-light">
            <h2 class="text-center mb-3">Instructions</h2>
            <p class="lead mb-3">Welcome to the Company Profile management page! Here you can update all relevant details about your company.</p>
            
            <h4 class="mb-2">Follow these steps to edit your [Company Name] profile:</h4>
            <ol class="mb-4">
                <li>Review the existing company details displayed on the left side of the screen.</li>
                <li>To make changes, click the <strong>"Edit Profile"</strong> button below.</li>
                <li>Fill in the fields you want to update, including:</li>
                <ul>
                    <li>Company Name</li>
                    <li>Description</li>
                    <li>Mission Statement</li>
                    <li>Logo Upload</li>
                    <li>Contact Information</li>
                    <li>Social Media Links</li>
                </ul>
                <li>Once you've made your changes, click the <strong>"Save Changes"</strong> button to update your profile.</li>
                <li>If you wish to discard changes, click <strong>"Cancel"</strong> to return to the previous view.</li>
            </ol>
        
            <button id="editProfileBtn" class="btn btn-primary mb-3" aria-label="Edit Company Porfile" onclick="showMainArea()">Edit Profile</button>
            <button id="cancelBtn" class="btn btn-primary mb-3" aria-label="Cancel" onclick="goBack()">Cancel</button>
        </div>
        
    
      <section class="container mt-5 p-4 shadow-lg rounded bg-white">
    <h2 id="companyTitle" class="text-center mb-4">[Company Name] Profile</h2>
    <hr class="my-4">

    <div id="mainArea" style="display: none;" class="row">
        <!-- Company Info Section -->
        <div class="col-md-8">
            <h2 id="companyName" class="loading-state mb-4">Loading...</h2>
            <input type="text" id="editCompanyName" class="form-control mb-3" style="display:none;" placeholder="Enter Company Name">
            <hr>        
            <div class="form-group">

            <!-- Industry -->
            <div class="mb-4">
                <label for="editCompanyIndustry" class="form-label">Industry</label>
                <select id="editCompanyIndustry" class="form-select" style="display:none;">
                    <option value="">Select Industry</option>
                    <option value="Tech">Tech</option>
                    <option value="Finance">Finance</option>
                    <option value="Healthcare">Healthcare</option>
                    <option value="Retail">Retail</option>
                    <option value="Education">Education</option>
                    <option value="Hospitality">Hospitality</option>
                    <option value="Construction">Construction</option>
                    <option value="Manufacturing">Manufacturing</option>
                    <option value="Transportation">Transportation</option>
                    <option value="Real Estate">Real Estate</option>
                    <option value="Legal Services">Legal Services</option>
                    <option value="Entertainment">Entertainment</option>
                    <option value="Marketing">Marketing</option>
                    <option value="Non-Profit">Non-Profit</option>
                    <option value="Telecommunications">Telecommunications</option>
                    <option value="Energy">Energy</option>
                    <option value="Pharmaceuticals">Pharmaceuticals</option>
                    <option value="Agriculture">Agriculture</option>
                    <option value="Cybersecurity">Cybersecurity</option>
                    <option value="E-commerce">E-commerce</option>
                    <option value="Consulting">Consulting</option>
                    <option value="Food and Beverage">Food and Beverage</option>
                    <option value="Textiles">Textiles</option>
                    <option value="Aerospace">Aerospace</option>
                    <option value="Biotechnology">Biotechnology</option>
                    <option value="Information Technology">Information Technology</option>
                </select>
            </div>
</div>
<div class="form-group">
    <p id="companyDescription" class="lead loading-state mb-3">Loading description...</p>
    <textarea id="editCompanyDescription" class="form-control mb-3" rows="3" style="display:none;" placeholder="Enter Company Description"></textarea>
    <button id="editCompanyDescriptionBtn" class="btn btn-secondary mb-2" style="display:none;">Edit Description</button>
    <button id="generateDescriptionBtn" class="btn btn-primary">Generate Description</button>
    <hr>

    <p><strong>Mission Statement:</strong></p>
    <p id="companyMissionStatement" class="loading-state">Loading...</p>
    <textarea id="editCompanyMissionStatement" class="form-control" rows="3" style="display:none;" placeholder="Enter Company Mission Statement"></textarea>
    <button id="editCompanyMissionStatementBtn" class="btn btn-secondary mb-2" style="display:none;">Edit Mission Statement</button>
</div>
<div class="form-group">

            <div class="mb-4">
                <label for="editCompanyLogo" class="form-label">Company Logo</label>
                <input type="file" id="editCompanyLogo" class="form-control" style="display:none;">
            </div>

            <div class="mb-4">
                <label for="editCompanyWebsite" class="form-label">Website</label>
                <input type="url" id="editCompanyWebsite" class="form-control" style="display:none;" placeholder="Enter Company Website">
            </div>
</div>
<hr>        

<div class="form-group">

            <!-- Location -->
            <div class="mb-4">
                <label for="editCompanyLocation" class="form-label">Location</label>
                <input type="text" id="editCompanyLocation" class="form-control" style="display:none;" placeholder="Enter Company Location">
            </div>
            <hr>        

            <!-- Contact Email -->
            <div class="mb-4">
                <label for="editCompanyEmail" class="form-label">Contact Email</label>
                <input type="email" id="editCompanyEmail" class="form-control" style="display:none;" placeholder="Enter Contact Email">
            </div>
            <hr>        

            <!-- Phone Number -->
            <div class="mb-4">
                <label for="editCompanyPhone" class="form-label">Phone Number</label>
                <input type="tel" id="editCompanyPhone" class="form-control" style="display:none;" placeholder="Enter Phone Number">
            </div>
        </div>
        <hr>        

        <div class="form-group">
            <!-- About Section -->
            <div class="mb-4">
                <label for="editCompanyAbout" class="form-label">About</label>
                <textarea id="editCompanyAbout" class="form-control" rows="4" style="display:none;" placeholder="Enter About Section"></textarea>
                <button id="editCompanyAboutBtn" class="btn btn-secondary mb-2" style="display:none;">Edit About</button>
            </div>
        </div>          <hr>        

            <!-- Company Size -->
            <div class="mb-4">
                <label for="editCompanySize" class="form-label">Company Size</label>
                <select id="editCompanySize" class="form-select" style="display:none;">
                    <option value="">Select Size</option>
                    <option value="1-10">1-10</option>
                    <option value="11-50">11-50</option>
                    <option value="51-200">51-200</option>
                    <option value="201+">201+</option>
                </select>
            </div>

            <!-- Founded Year -->
            <div class="mb-4">
                <label for="editCompanyFounded" class="form-label">Founded Year</label>
                <input type="number" id="editCompanyFounded" class="form-control" style="display:none;" placeholder="Enter Founded Year">
            </div>
        </div>
<hr>        
            <!-- Save/Cancel Buttons -->
            <div id="editButtons" class="mt-4" style="display:none;">
                <button id="saveChangesBtn" class="btn btn-primary">Save Changes</button>
                <button id="cancelChangesBtn" class="btn btn-secondary">Cancel</button>
            </div>
        </div>

        <!-- Sidebar Section -->
        <div class="col-md-4 text-center">
            <h4 class="mt-4">Company Logo</h4>
            <div class="p-3 border rounded shadow-sm bg-light mb-4">
                <img id="companyLogo" src="../images/sq_logo_n_BG.png" alt="Company Logo" class="img-fluid rounded-circle mb-2">
                <input type="file" id="editCompanyLogo" class="form-control mt-2" style="display:none;">
            </div>

            <!-- Social Media Links -->
            <div class="social-icons mt-3">
                <h5>Social Media Links</h5>
                <div id="socialLinks" class="mb-3">
                    <a href="#" id="facebookLink" class="btn btn-outline-primary btn-sm me-2" target="_blank">Facebook</a>
                    <a href="#" id="twitterLink" class="btn btn-outline-primary btn-sm me-2" target="_blank">Twitter</a>
                    <a href="#" id="linkedinLink" class="btn btn-outline-primary btn-sm" target="_blank">LinkedIn</a>
                </div>

                <!-- Editable Inputs for Social Media Links -->
                <div id="socialInputs" style="display:none;">
                    <input type="text" id="editFacebook" class="form-control mb-2" placeholder="Enter Facebook URL">
                    <input type="text" id="editTwitter" class="form-control mb-2" placeholder="Enter Twitter URL">
                    <input type="text" id="editLinkedIn" class="form-control mb-2" placeholder="Enter LinkedIn URL">
                </div>
            </div>
        </div>
    </div>
</section>
    </main>
    

    <div id="errorMessage" style="display: none; color: red; font-weight: bold;">
        <p>Company not found. Please log in to create a page.</p>
    </div>
    
<script>

       // Function to toggle visibility of textareas and loading states
       function toggleEdit(elementId, loadingId, buttonId) {
        const textarea = document.getElementById(elementId);
        const loading = document.getElementById(loadingId);
        const button = document.getElementById(buttonId);

        if (loading.style.display !== 'none') {
            loading.style.display = 'none';
            textarea.style.display = 'block';
            button.style.display = 'block';
        } else {
            textarea.style.display = 'none';
            button.style.display = 'none';
            loading.style.display = 'block';
        }
    }

    // Event listeners for buttons to toggle edit mode
    document.getElementById('editCompanyDescriptionBtn').addEventListener('click', () => {
        toggleEdit('editCompanyDescription', 'companyDescription', 'editCompanyDescriptionBtn');
    });

    document.getElementById('editCompanyMissionStatementBtn').addEventListener('click', () => {
        toggleEdit('editCompanyMissionStatement', 'companyMissionStatement', 'editCompanyMissionStatementBtn');
    });

    document.getElementById('editCompanyAboutBtn').addEventListener('click', () => {
        toggleEdit('editCompanyAbout', 'editCompanyAbout', 'editCompanyAboutBtn');
    });
    
function goBack() {
    window.history.back();
}

function showMainArea() {
            // Hide the instructions and show the main area
            document.getElementById("mainArea").style.display = "block";

        }

document.getElementById("generateDescriptionBtn").addEventListener("click", function() {
    const industries = Array.from(document.getElementById("editCompanyIndustry").selectedOptions).map(option => option.value);
    const companyDescriptionField = document.getElementById("editCompanyDescription");
    const companyDescription = companyDescriptionField.value;
    
    // Check if at least one industry is selected and the company description is empty (or black)
    if (industries.length > 0 && companyDescription === "") {
        const companyName =  document.getElementById('editCompanyName').value; // Replace with the actual company name
        
        // Define description templates for different industries
        const descriptions = { 
    "Tech": [
        `At ${companyName}, we are revolutionizing the Tech industry with innovative solutions that enhance user experience.`,
        `${companyName} leads the way in Tech, focusing on cutting-edge technologies to empower businesses.`
    ],
    "Finance": [
        `${companyName} is your trusted partner in the Finance industry, delivering unparalleled financial services.`,
        `In the competitive world of Finance, ${companyName} stands out with tailored solutions for our clients.`
    ],
    "Healthcare": [
        `${companyName} is dedicated to improving lives in the Healthcare industry through innovative solutions.`,
        `As a leader in Healthcare, ${companyName} focuses on quality patient care and advanced medical technologies.`
    ],
    "Retail": [
        `At ${companyName}, we are transforming the Retail experience with personalized service and quality products.`,
        `Leading the Retail industry, ${companyName} is dedicated to providing exceptional customer experiences.`
    ],
    "Education": [
        `At ${companyName}, we are committed to enhancing Education through innovative learning solutions.`,
        `In the Education sector, ${companyName} leads with a focus on accessibility and quality education for all.`
    ],
    "Hospitality": [
        `At ${companyName}, we create unforgettable experiences in the Hospitality industry with exceptional service.`,
        `Dedicated to excellence, ${companyName} redefines standards in the Hospitality sector with our customer-first approach.`
    ],
    "Construction": [
        `${companyName} is at the forefront of the Construction industry, delivering innovative building solutions.`,
        `With a commitment to safety and quality, ${companyName} sets new benchmarks in Construction standards.`
    ],
    "Manufacturing": [
        `${companyName} is revolutionizing the Manufacturing industry with state-of-the-art technology and processes.`,
        `At ${companyName}, we prioritize efficiency and quality, ensuring the best products for our clients.`
    ],
    "Transportation": [
        `At ${companyName}, we streamline the Transportation industry with efficient logistics and services.`,
        `Dedicated to reliability, ${companyName} is your partner in navigating the complexities of Transportation.`
    ],
    "Real Estate": [
        `${companyName} is committed to helping you find your dream property in the Real Estate market.`,
        `With a deep understanding of the Real Estate landscape, ${companyName} offers tailored solutions for buyers and sellers.`
    ],
    "Legal Services": [
        `At ${companyName}, we provide expert Legal Services tailored to meet your unique needs.`,
        `Dedicated to justice, ${companyName} is your trusted partner in navigating the complexities of the Legal field.`
    ],
    "Entertainment": [
        `At ${companyName}, we create memorable experiences in the Entertainment industry that captivate audiences.`,
        `With a passion for creativity, ${companyName} is at the forefront of innovation in the Entertainment sector.`
    ],
    "Marketing": [
        `At ${companyName}, we are redefining the Marketing landscape with data-driven strategies and creative solutions.`,
        `Dedicated to your success, ${companyName} develops innovative Marketing campaigns that engage and inspire.`
    ],
    "Non-Profit": [
        `At ${companyName}, we are committed to making a difference in the Non-Profit sector through impactful initiatives.`,
        `With a focus on community engagement, ${companyName} strives to create positive change in the Non-Profit field.`
    ],
    "Telecommunications": [
        `At ${companyName}, we lead the Telecommunications industry with cutting-edge communication solutions.`,
        `Dedicated to connectivity, ${companyName} is your partner in navigating the evolving landscape of Telecommunications.`
    ],
    "Energy": [
        `At ${companyName}, we are committed to sustainable practices in the Energy sector to power a greener future.`,
        `Leading the way in renewable Energy, ${companyName} focuses on innovative solutions for sustainable living.`
    ],
    "Pharmaceuticals": [
        `At ${companyName}, we are dedicated to advancing health through innovative Pharmaceuticals and research.`,
        `With a focus on quality and efficacy, ${companyName} is a leader in the Pharmaceuticals industry.`
    ],
    "Agriculture": [
        `At ${companyName}, we are revolutionizing the Agriculture industry with sustainable farming practices.`,
        `Dedicated to food security, ${companyName} leverages technology to enhance productivity in Agriculture.`
    ],
    "Cybersecurity": [
        `At ${companyName}, we provide top-notch Cybersecurity solutions to protect your digital assets.`,
        `With a commitment to safety, ${companyName} is your partner in navigating the complexities of Cybersecurity.`
    ],
    "E-commerce": [
        `At ${companyName}, we are transforming the E-commerce landscape with seamless online shopping experiences.`,
        `Dedicated to customer satisfaction, ${companyName} offers a wide range of products in the E-commerce market.`
    ],
    "Consulting": [
        `At ${companyName}, we provide expert Consulting services tailored to your business needs.`,
        `With a focus on growth and strategy, ${companyName} helps you navigate challenges in the Consulting space.`
    ],
    "Food and Beverage": [
        `At ${companyName}, we are passionate about delivering quality products in the Food and Beverage industry.`,
        `With a commitment to flavor and quality, ${companyName} sets the standard in Food and Beverage services.`
    ],
    "Textiles": [
        `At ${companyName}, we are dedicated to excellence in the Textiles industry through quality craftsmanship.`,
        `With a focus on innovation, ${companyName} leads the way in sustainable practices in the Textiles sector.`
    ],
    "Aerospace": [
        `At ${companyName}, we push the boundaries of innovation in the Aerospace industry with cutting-edge technologies.`,
        `Dedicated to safety and efficiency, ${companyName} is a leader in the Aerospace field.`
    ],
    "Biotechnology": [
        `At ${companyName}, we are transforming lives through groundbreaking Biotechnology research and solutions.`,
        `With a focus on innovation, ${companyName} leads the way in the Biotechnology industry.`
    ],
    "Information Technology": [
        `At ${companyName}, we are committed to driving success in the Information Technology sector with innovative solutions.`,
        `As leaders in Information Technology, ${companyName} empowers businesses to leverage technology effectively.`
    ]
};


        // Select random descriptions for each selected industry
        const randomDescriptions = industries.map(industry => {
            const industryDescriptions = descriptions[industry] || [];
           // if (industryDescriptions.length > 0) {
                // Randomly select a description for the industry
                return industryDescriptions[Math.floor(Math.random() * industryDescriptions.length)];
          //  }
            return '';
        }).filter(desc => desc); // Remove any empty descriptions

        // Combine the random descriptions into a single string
        const shortDescription = randomDescriptions.join(" ");

        // Set the generated description in the company description field
        document.getElementById("editCompanyDescription").value = shortDescription;
        document.getElementById("companyDescription").innerHTML = shortDescription;
    } else {
        alert("Please select at least one industry and ensure the company description is empty.");
    }
});


</script>

    <!-- Footer -->
    <footer id="dynamic-footer" class="text-center mt-5"></footer>
    
    <!-- Firebase configuration/ Login& Out -->
    <script type="module" src="../public/js/main.js"></script>
    
    <!-- Dynamic Schema Markup -->
    <script type="module">
        import { db, auth } from '../public/js/main.js';
        import { addDoc, doc, setDoc, getDoc, collection , onSnapshot, updateDoc } from "https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore.js";
        document.getElementById("errorMessage").style.display = "none"; // Hide error message if shown


        toggleEditMode(false)
        const urlParams = new URLSearchParams(window.location.search);
        const companyId = urlParams.get('companyId');
        document.getElementById("instructions").style.display = "none";

        auth.onAuthStateChanged(user => {
            if (user || companyId ) {
                const userId = user.uid;
                
                if (!companyId) {
                toggleEditMode(true);
                const urlParams = new URLSearchParams(window.location.search);
                let companyName = urlParams.get('create');
                if(!companyName){companyName = "Company"};
                document.title = document.title.replace("[Company Name]", companyName);

                document.getElementById("instructions").innerHTML = 
                document.getElementById("instructions").innerHTML.replace("[Company Name]", companyName);
                document.getElementById("companyTitle").innerHTML = 
                document.getElementById("companyTitle").innerHTML.replace("[Company Name]", companyName);
                document.getElementById("editCompanyName").value = companyName;
                document.getElementById('companyName').textContent = companyName;

// Replace placeholder in the entire document body
//document.body.innerHTML = document.body.innerHTML.replace(/\[Company Name\]/g, companyName);


                // Show instructions and hide main area
                document.getElementById("mainArea").style.display = "none";
                document.getElementById("instructions").style.display = "block";

                
            }else {
                    const companyRef = doc(db, "Companies", companyId);
                    getDoc(companyRef).then((docSnapshot) => {
                        if (docSnapshot.exists()) {
                            const companyData = docSnapshot.data();
    
                            // Load company info
                            loadCompanyInfo(companyData);
                            // Load job listings based on the companyId
                            loadJobListings(companyId);
    
                            // Check if the user is the admin of this company
                            if (userId === companyData.adminId) {
                                toggleEditMode(true);
                                document.getElementById("instructions").style.display = "block";

                            }
                        } else {
                            console.log("Company not found");
                            if (userId) {
                            document.getElementById("mainArea").style.display = "none";
                            document.getElementById("instructions").style.display = "block";
                        }else{
                            document.getElementById("errorMessage").style.display = "block"; // Hide error message if shown
                            document.getElementById("mainArea").style.display = "none";
                            document.getElementById("instructions").style.display = "none";

                        }
                    }
                    }).catch((error) => {
                        console.error("Error fetching company data:", error);
                    });
                }
            } else {
                // User not logged in
            }
        });
    
        // Load company info
        async function loadCompanyInfo(companyData) {
            document.getElementById('companyName').textContent = companyData.name || 'Company Name';
            document.getElementById('companyDescription').textContent = companyData.description || 'Company description...';
            document.getElementById('companyMissionStatement').textContent = companyData.missionStatement || 'Mission statement...';
            document.getElementById('companyLogo').src = companyData.logo || '../images/sq_logo_n_BG.png';
    
            // Update social media links
            document.getElementById('facebookLink').setAttribute('href', companyData.socialMedia?.facebook || '#');
            document.getElementById('twitterLink').setAttribute('href', companyData.socialMedia?.twitter || '#');
            document.getElementById('linkedinLink').setAttribute('href', companyData.socialMedia?.linkedin || '#');
    
            // Pre-fill the edit fields
            document.getElementById('editFacebook').value = companyData.socialMedia?.facebook || '';
            document.getElementById('editTwitter').value = companyData.socialMedia?.twitter || '';
            document.getElementById('editLinkedIn').value = companyData.socialMedia?.linkedin || '';
    
            // Other fields
            document.getElementById('editCompanyWebsite').value = companyData.website || '';
            document.getElementById('editCompanyIndustry').value = companyData.industry || '';
            document.getElementById('editCompanyLocation').value = companyData.location || '';
            document.getElementById('editCompanyEmail').value = companyData.email || '';
            document.getElementById('editCompanyPhone').value = companyData.phone || '';
            document.getElementById('editCompanyAbout').value = companyData.about || '';
            document.getElementById('editCompanySize').value = companyData.size || '';
            document.getElementById('editCompanyFounded').value = companyData.founded || '';
        
            let companyName = companyData.name;
            document.title = document.title.replace("[Company Name]", companyName);

            if(!companyName){companyName = "Company"};
                
                document.getElementById("instructions").innerHTML = 
                document.getElementById("instructions").innerHTML.replace("[Company Name]", companyName);
                document.getElementById("companyTitle").innerHTML = 
                document.getElementById("companyTitle").innerHTML.replace("[Company Name]", companyName);

        }
    
        // Load job listings for the company
        async function loadJobListings(companyId) {
            const jobsRef = collection(db, "Jobs");
            const q = query(jobsRef, where("companyId", "==", companyId));
            const unsubscribe = onSnapshot(q, (querySnapshot) => {
                const jobsContainer = document.getElementById("jobsContainer");
                jobsContainer.innerHTML = ""; // Clear existing jobs
                querySnapshot.forEach((doc) => {
                    const jobData = doc.data();
                    const jobElement = document.createElement("div");
                    jobElement.classList.add("job-listing");
                    jobElement.innerHTML = `<h4>${jobData.title}</h4><p>${jobData.description}</p>`;
                    jobsContainer.appendChild(jobElement);
                });
            });
        }
    
        // Toggle edit mode
        function toggleEditMode(editing) {
            document.getElementById("editProfileBtn").innerText = editing ? "Edit" : "Edit Profile";
            const elementsToToggle = [
                'editCompanyName', 
                'editCompanyDescription', 
                'editCompanyMissionStatement', 
                'editCompanyWebsite', 
                'editCompanyIndustry', 
                'editCompanyLocation', 
                'editCompanyEmail', 
                'editCompanyPhone', 
                'editCompanyAbout', 
                'editCompanySize', 
                'editCompanyFounded', 
                'socialInputs', 
                'editButtons'
            ];
            document.getElementById("mainArea").style.display = "block";
 
            elementsToToggle.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.style.display = editing ? 'block' : 'none';
                }
            });
        }
    
        // Update company data

            async function updateCompanyData(companyId) {
    const updatedData = {
        companyName: document.getElementById('editCompanyName').value,
        description: document.getElementById('editCompanyDescription').value,
        missionStatement: document.getElementById('editCompanyMissionStatement').value,
        socialMedia: {
            facebook: document.getElementById('editFacebook').value,
            twitter: document.getElementById('editTwitter').value,
            linkedin: document.getElementById('editLinkedIn').value,
        },
        website: document.getElementById('editCompanyWebsite').value,
        industry: document.getElementById('editCompanyIndustry').value,
        location: document.getElementById('editCompanyLocation').value,
        email: document.getElementById('editCompanyEmail').value,
        phone: document.getElementById('editCompanyPhone').value,
        about: document.getElementById('editCompanyAbout').value,
        size: document.getElementById('editCompanySize').value,
        founded: document.getElementById('editCompanyFounded').value,
        jobs: [],
            
    };


    try {
        let companyRef;
        const urlParams = new URLSearchParams(window.location.search);

        console.log("urlParams:", urlParams.toString());

        // Check if we are creating a new company
        if (urlParams.get('create')) {
            console.log("Creating a new company...");

                 // Use `addDoc` to auto-generate a document ID
                 companyRef = await addDoc(collection(db, "Companies"), updatedData);


            console.log("Company created successfully with ID:", companyRef.id);

       // goBack();

        // Pass the newly created companyId back to the previous page
      //  window.location.href = `previousPage.html?companyId=${companyRef.id}`;
    } else {
            // If updating an existing company
            console.log("Updating existing company with ID:", companyId);

            companyRef = doc(db, "Companies", companyId);

            await setDoc(companyRef, updatedData, { merge: true });

            console.log("Company updated successfully with ID:", companyId);

            // Redirect or go back to the previous page
          //  window.location.href = `previousPage.html?companyId=${companyId}`;
        }

        // Load the updated company information and exit edit mode
        loadCompanyInfo(updatedData); 
        toggleEditMode(false);

    } catch (error) {
        // Log any errors that occur
        console.error("Error occurred while updating company:", error);
        
        // Optionally, display an error message to the user
        alert("An error occurred while updating the company. Please try again.");
    }
}


        
    
        // Event Listeners
        document.getElementById("editProfileBtn").addEventListener("click", function() {
            const editing = this.innerText === "Edit Profile";
            toggleEditMode(editing);
            if (editing) {
                document.getElementById("editCompanyName").value = document.getElementById('companyName').textContent;
                document.getElementById("editCompanyDescription").value = document.getElementById('companyDescription').textContent;
                document.getElementById("editCompanyMissionStatement").value = document.getElementById('companyMissionStatement').textContent;
            }
        });
    
        document.getElementById("saveChangesBtn").addEventListener("click", function() {
            updateCompanyData(companyId);
        });
    
        document.getElementById("cancelChangesBtn").addEventListener("click", function() {
            toggleEditMode(false);
        });

       

    </script>
          
</body>
</html>
